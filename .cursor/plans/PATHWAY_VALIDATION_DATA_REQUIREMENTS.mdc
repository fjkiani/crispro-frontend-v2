# üß¨ PATHWAY VALIDATION ROADMAP

**Version**: 1.1  
**Date**: January 28, 2025  
**Status**: ‚úÖ DAY 1 COMPLETE - Proceeding to Day 2  
**Owner**: Manager Agent (Coordinating Data Acquisition)  
**Working Directory**: `/Users/fahadkiani/Desktop/development/crispr-assistant-main` (MAIN REPO - NOT WORKTREE)

---

## üìä EXECUTIVE SUMMARY

**Mission**: Validate all 7 pathways (DDR, MAPK, PI3K, VEGF, HER2, IO, Efflux) across multiple cancer types for mechanism-based trial matching and resistance prediction.

**Current Status**: 
- ‚úÖ **DAY 1 COMPLETE**: Dataset transformed, TMB computed, format standardized
- ‚úÖ **469 patients** with mutations + platinum response 
- ‚úÖ **TMB computed**: Mean 2.34 mut/Mb, 321 patients with mutations
- ‚úÖ **Response standardized**: 396 sensitive, 31 resistant, 42 refractory
- ‚è≥ **Day 2**: Acquire HRD scores from TCGA publications
- ‚ùå Missing: HRD scores, other cancer types

**Priority**: Complete ovarian cancer first (P0), then Tier 1 gynecological cancers (P1)

---

## ‚úÖ DAY 1 COMPLETION SUMMARY

**Executed**: January 28, 2025

| Task | Status | Output |
|------|--------|--------|
| 1. Transform dataset | ‚úÖ DONE | `data/validation/tcga_ov_469_transformed.json` |
| 2. Compute TMB | ‚úÖ DONE | `data/validation/tcga_ov_469_with_tmb.json` |
| 3. Standardize format | ‚úÖ DONE | `data/validation/tcga_ov_469_validated.json` |

**TMB Results**:
- Patients with TMB: 321/469 (68.4%)
- Mean TMB: 2.34 mut/Mb
- Median TMB: 1.79 mut/Mb
- Range: 0.05 - 49.82 mut/Mb
- TMB-Low: 462 | TMB-Intermediate: 4 | TMB-High: 3

**Response Distribution**:
- Sensitive: 396 (84.4%)
- Resistant: 31 (6.6%)
- Refractory: 42 (9.0%)

---

## üéØ DAY 2 TASKS - JR AGENT ASSIGNMENT

### Mission: Acquire HRD Scores for 469 TCGA-OV Patients

**Agent**: Jr  
**Timeline**: 2-4 hours  
**Priority**: HIGH

---

### Task 2.1: Download TCGA HRD Scores (Primary Source)

**Source**: Marquard et al. 2015 - "Pan-cancer analysis of genomic scar signatures"
- **PubMed**: https://pubmed.ncbi.nlm.nih.gov/25749574/
- **Expected fields**: LOH score, TAI score, LST score, HRD sum

**Steps**:
1. Download supplementary data from paper
2. Extract TCGA-OV patient HRD scores
3. Match by `tcga_patient_id` to our 469 patients
4. Report coverage (target: ‚â•80%)

**Output file**: `data/validation/tcga_ov_hrd_scores_raw.json`

**‚ùì CLARIFYING QUESTIONS FOR JR**:
1. **Supplementary Data Location**: 
   - Is there a direct link to the supplementary data file? (Often in "Supplementary Materials" section of paper)
   - What format is the data in? (Excel, CSV, TSV, TXT?)
   - If not directly available, should we extract from the paper's figures/tables?

2. **Patient ID Matching**:
   - Our patient IDs format: What format do we use? (e.g., "TCGA-XX-XXXX" or "TCGA-XX-XXXX-XX" or just "TCGA-XX-XXXX" without sample suffix?)
   - Marquard format: What format do they use? (May need to normalize)
   - Matching strategy: Exact match first, then fuzzy match? (e.g., strip sample suffixes)

3. **TCGA-OV Specificity**:
   - Does Marquard et al. have TCGA-OV specifically, or is it pan-cancer?
   - If pan-cancer, how do we filter to ovarian cancer only? (By patient ID prefix or cancer type column?)

4. **Data Validation**:
   - Should we validate HRD scores against known BRCA1/2 mutations? (HRD+ patients should have higher HRD scores)
   - What if HRD scores are negative or >100? (Data quality check)

---

### Task 2.2: Alternative Source - cBioPortal CHORD Scores

If Marquard coverage <80%, check cBioPortal:

```python
import httpx

BASE_URL = "https://www.cbioportal.org/api"
STUDY_ID = "ov_tcga_pan_can_atlas_2018"

# Check for HRD/CHORD clinical attributes
response = httpx.get(
    f"{BASE_URL}/studies/{STUDY_ID}/clinical-data",
    params={"clinicalDataType": "SAMPLE", "projection": "DETAILED"}
)

# Look for: HRD_SCORE, CHORD_HRD, HOMOLOGOUS_RECOMBINATION_DEFICIENCY
```

**‚ùì CLARIFYING QUESTIONS FOR JR**:
1. **Data Format**:
   - What format does cBioPortal return? (JSON array of clinical attributes?)
   - Are CHORD scores numeric or categorical? (e.g., "HRD+" vs. 0.85)
   - How do we convert CHORD scores to HRD sum? (CHORD is 0-1 probability, HRD sum is 0-100+)

2. **Patient Matching**:
   - cBioPortal uses sample IDs (e.g., "TCGA-XX-XXXX-01A"), our dataset uses patient IDs (e.g., "TCGA-XX-XXXX")
   - Strategy: Strip sample suffix (-01A, -01B) to match patient IDs?

3. **Combining Sources**:
   - If Marquard has 60% coverage and cBioPortal has 40%, should we combine them?
   - What if both sources have data for the same patient? (Prefer Marquard, or average?)

4. **Missing Data Handling**:
   - What if cBioPortal has different field names? (e.g., "HRD_STATUS" instead of "HRD_SCORE")
   - Should we search for multiple field name variations?

---

### Task 2.3: Merge HRD Scores into Validated Dataset

**Input**: 
- `data/validation/tcga_ov_469_validated.json` (Day 1 output)
- `data/validation/tcga_ov_hrd_scores_raw.json` (Task 2.1 output)

**Output**: `data/validation/tcga_ov_469_with_hrd.json`

**Schema**:
```python
for patient in patients:
    patient["biomarkers"]["hrd_score"] = matched_hrd.get("hrd_sum")
    patient["biomarkers"]["loh_score"] = matched_hrd.get("loh_score")
    patient["biomarkers"]["tai_score"] = matched_hrd.get("tai_score")
    patient["biomarkers"]["lst_score"] = matched_hrd.get("lst_score")
    patient["biomarkers"]["hrd_status"] = "HRD+" if hrd_sum >= 42 else "HRD-"
```

**HRD Thresholds**:
- HRD+: HRD sum ‚â• 42 (Myriad threshold)
- HRD-: HRD sum < 42

---

### Task 2.4: Generate HRD Summary Report

**Output**: `data/validation/tcga_ov_hrd_summary.json`

```json
{
  "total_patients": 469,
  "patients_with_hrd": "N",
  "hrd_coverage": "N/469 (X%)",
  "hrd_distribution": {
    "HRD+": "N",
    "HRD-": "N"
  },
  "hrd_statistics": {
    "mean": "X",
    "median": "X",
    "min": "X",
    "max": "X"
  },
  "source": "Marquard et al. 2015 / cBioPortal",
  "acquisition_date": "2025-01-28"
}
```

---

### Task 2.5: Success Criteria

| Metric | Target | Status |
|--------|--------|--------|
| HRD coverage | ‚â•80% (375/469) | ‚è≥ |
| Match rate | ‚â•90% of available | ‚è≥ |
| HRD+ patients | >0 | ‚è≥ |
| HRD- patients | >0 | ‚è≥ |

**If coverage <80%**: Report gap, defer to Phase 2 (proceed with TMB-only validation)

---

## üîç CURRENT DATA INVENTORY

### ‚úÖ What We Have (Day 1 Complete)

#### 1. Ovarian Cancer (TCGA-OV) - ‚úÖ TRANSFORMED

**Files**:
| File | Status | Description |
|------|--------|-------------|
| `tcga_ov_platinum_with_mutations.json` | ‚úÖ Source | 469 patients, 28,517 mutations |
| `tcga_ov_469_transformed.json` | ‚úÖ Task 1 | Standardized schema |
| `tcga_ov_469_with_tmb.json` | ‚úÖ Task 2 | TMB scores added |
| `tcga_ov_469_validated.json` | ‚úÖ Task 3 | Final validated format |

**Data Quality**:
| Element | Coverage | Status |
|---------|----------|--------|
| Patients | 469 | ‚úÖ |
| Mutations | 321/469 (68.4%) | ‚úÖ |
| Platinum Response | 469/469 (100%) | ‚úÖ |
| TMB Scores | 469/469 (100%) | ‚úÖ |
| HRD Scores | 0/469 (0%) | ‚è≥ Day 2 |

---

## üó∫Ô∏è EXECUTION ROADMAP

### **Phase 1: Complete Ovarian Cancer (P0)** - 3 days

| Day | Tasks | Status |
|-----|-------|--------|
| Day 1 | Transform, TMB, Standardize | ‚úÖ COMPLETE |
| Day 2 | Acquire HRD scores | ‚è≥ IN PROGRESS |
| Day 3 | Validate pathways, Generate report | ‚è≥ PENDING |

#### Day 1 Tasks ‚úÖ COMPLETE
- [x] Transform 469-patient dataset to validation schema
- [x] Compute TMB for all patients (Mean: 2.34 mut/Mb)
- [x] Standardize treatment response format
- [x] Generate validated dataset

#### Day 2 Tasks ‚è≥ JR AGENT ASSIGNED
- [ ] Download HRD scores from Marquard et al. 2015
- [ ] Alternative: Check cBioPortal for CHORD scores
- [ ] Match to 469 patients by patient_id
- [ ] Add HRD scores to validated dataset
- [ ] Generate HRD summary report

#### Day 3 Tasks üìã PENDING
- [ ] Run pathway validation scripts
- [ ] Generate validation report
- [ ] Confirm resistance prediction signals (MAPK/NF1)
- [ ] Manager review and sign-off

**Deliverable**: Fully compliant ovarian cancer dataset (469 patients with TMB + HRD)

---

### **Phase 2: Tier 1 Gynecological Cancers (P1)** - 5-7 days

**Goal**: Acquire endometrial and cervical cancer datasets

- [ ] Endometrial (TCGA-UCEC): 500+ patients, PI3K/MSI focus
- [ ] Cervical (TCGA-CESC): 300+ patients, HPV/IO focus

**Deliverable**: 800+ additional patients

---

### **Phase 3: Tier 2 High-Signal Cancers (P2)** - 7-10 days

- [ ] Breast (TCGA-BRCA): 1000+ patients, DDR/HER2/PI3K
- [ ] Melanoma (TCGA-SKCM): 400+ patients, MAPK/IO
- [ ] Lung Adeno (TCGA-LUAD): 500+ patients, MAPK/IO
- [ ] Colorectal (TCGA-COAD): 600+ patients, MAPK/MSI

**Deliverable**: 2500+ additional patients

---

### **Phase 4: Tier 3 Complete Coverage (P3)** - 5-7 days

- [ ] Kidney (TCGA-KIRC): VEGF pathway
- [ ] Pancreatic (TCGA-PAAD): DDR/MAPK
- [ ] Prostate (TCGA-PRAD): DDR (BRCA2)
- [ ] Gastric (TCGA-STAD): HER2/MSI
- [ ] Bladder (TCGA-BLCA): IO (TMB)

**Deliverable**: Complete 7 pathways √ó 10+ cancer types

---

## üìä SUCCESS METRICS

### Phase 1 (Ovarian Cancer) - Current Focus

| Metric | Target | Current | Status |
|--------|--------|---------|--------|
| Patients | 469 | 469 | ‚úÖ |
| TMB coverage | 100% | 100% | ‚úÖ |
| HRD coverage | ‚â•80% | 0% | ‚è≥ Day 2 |
| Response labels | 100% | 100% | ‚úÖ |
| Validation ready | Yes | Pending HRD | ‚è≥ |

---

## üö® IMPORTANT: WORKSPACE CONFIGURATION

**USE MAIN REPO - NOT WORKTREE**

| Setting | Value |
|---------|-------|
| Working Directory | `/Users/fahadkiani/Desktop/development/crispr-assistant-main` |
| Data Location | `data/validation/` |
| Scripts Location | `scripts/data_acquisition/` |

**DO NOT USE**: `/Users/fahadkiani/.cursor/worktrees/crispr-assistant-main/apd/` (worktree has missing files)

---

## üìã JR AGENT CHECKLIST - DAY 2

```bash
# Working directory
cd /Users/fahadkiani/Desktop/development/crispr-assistant-main

# Task 2.1: Download HRD scores
python scripts/data_acquisition/download_tcga_hrd.py

# Task 2.3: Merge into validated dataset
python scripts/data_acquisition/merge_hrd_scores.py

# Task 2.4: Generate summary
python scripts/data_acquisition/generate_hrd_summary.py
```

**Expected outputs**:
- `data/validation/tcga_ov_hrd_scores_raw.json`
- `data/validation/tcga_ov_469_with_hrd.json`
- `data/validation/tcga_ov_hrd_summary.json`

---

**Status**: ‚úÖ DAY 1 COMPLETE - ‚è≥ DAY 2 IN PROGRESS  
**Last Updated**: January 28, 2025  
**Manager Review**: Day 1 verified, Day 2 tasks assigned to Jr  
**Next Milestone**: Day 2 complete (HRD acquisition + merge)
