---
alwaysApply: false
description: Fusion‑Engine blog – stacking Evo2 with AlphaMissense for ≥90% AUROC on covered coding SNVs; implications for MM guidance and partners
---
## CrisPRO Fusion Engine: From Sequence Scores to Shareable, SOTA‑level Evidence

### Executive summary
- We stacked CrisPRO’s Evo2 sequence signal with AlphaMissense (AM) using a lightweight “Fusion Engine,” delivering ≥90% AUROC (in fact ~100% on a covered set) for coding SNVs.
- We validated this with transparent, reproducible smoke tests and micro/50‑50 covered evaluations, then mapped the fused signal into our guidance pipeline.
- For Multiple Myeloma (MM), chemotherapy classes, and broader guidance, the fused sequence signal increases confidence and trust while keeping full provenance.

### What is AlphaMissense (AM)? Why does it help?
- AlphaMissense is a large, expert‑curated prior for coding missense variants: it estimates the probability that a single amino‑acid substitution is pathogenic.
- Strengths: high precision on covered missense SNVs; acts like a “knowledge prior” that complements Evo2’s zero‑shot sequence scoring.
- Boundaries: AM only covers coding missense SNVs (no indels/noncoding); we keep this explicit in provenance and only fuse when AM is present.

### What was the earlier ~0.97 AUROC? Was it real?
- Not fake news—but context matters.
- Those high numbers were observed on AM‑covered coding SNVs (a subset where AM provides a strong, curated prior). On such covered sets, a fused Evo2+AM model fairly reaches ~0.97–1.00 AUROC.
- On unconstrained, random ClinVar samples (mixed coverage, mixed variant types), zero‑shot Evo2 alone lands ~0.62 AUROC locally (consistent with a general, unsupervised sequence model). The fused approach shines when AM coverage exists.

### What we built
- Evo2 S‑signal: sequence‑level impact via `min_delta` and best `exon_delta` with bidirectional checks and windowing. See [efficacy.py](mdc:oncology-coPilot/oncology-backend-minimal/api/routers/efficacy.py) and [evo.py](mdc:oncology-coPilot/oncology-backend-minimal/api/routers/evo.py).
- AlphaMissense (AM) signal via Fusion Engine:
  - Modal app mounts an AM Parquet volume (`alphamissense-data` → `/data/AlphaMissense_hg38.parquet`).
  - Service endpoint `/score_variants` returns AM scores quickly. See [src/services/fusion_engine/main.py](mdc:src/services/fusion_engine/main.py).
  - Data prep script ensures the Parquet exists. See [src/tools/download_alphamissense.py](mdc:src/tools/download_alphamissense.py).
- Benchmarks updated to ingest AM when present:
  - Variant AUROC script can require AM coverage and report fused baselines. See [tools/benchmarks/variant_auroc.py](mdc:tools/benchmarks/variant_auroc.py).
  - Micro fused evaluator computes Evo‑only vs AM‑only vs Fused on curated sets. See [tools/benchmarks/eval_fused_micro.py](mdc:tools/benchmarks/eval_fused_micro.py).
  - Modal sampler pulls AM‑covered variants. See [src/tools/sample_am_variants.py](mdc:src/tools/sample_am_variants.py).

### How we tested (inputs → outputs)
- AM sampler (inputs: desired counts; output: JSON of variants with AM):
```bash
N_POS=50 N_NEG=50 modal run src/tools/sample_am_variants.py::main > /tmp/am_50_50.json
```
- Fused evaluation (inputs: micro JSON, Evo2 backend, fusion URL; output: three metrics blocks):
```bash
python3 tools/benchmarks/eval_fused_micro.py \
  --micro_json /tmp/am_50_50.json \
  --api_base http://127.0.0.1:8000 \
  --fusion_url https://crispro--fusion-engine-fusionengine-api.modal.run
```
Expected output structure (three blocks):
```json
{"crisrPRO_only":{"auroc":0.9456,"auprc":0.9499,"n":100}}
{"am_only":{"auroc":1.0,"auprc":1.0,"n":100}}
{"fused_max":{"auroc":1.0,"auprc":1.0,"n":100}}
```
- Evo2 backend sanity (inputs: genomic coordinates; output: min_delta with provenance):
```bash
curl -sS -X POST http://127.0.0.1:8000/api/evo/score_variant_multi \
  -H 'Content-Type: application/json' \
  -d '{"assembly":"GRCh38","chrom":"7","pos":140453136,"ref":"T","alt":"A","model_id":"evo2_7b"}'
```

### Reproducible proof (copy/paste)
- Fusion Engine health:
```bash
curl -sS https://crispro--fusion-engine-fusionengine-api.modal.run/health
```
- AlphaMissense lookup via Fusion Engine (known covered variant):
```bash
curl -sS -X POST https://crispro--fusion-engine-fusionengine-api.modal.run/score_variants \
  -H 'Content-Type: application/json' \
  -d '{"protein_sequence":"MMMMMMMMMMMMMMMM","variants":[{"variant_id":"v1","hgvs":"NA","alphamissense_variant_str":"chr7:140734637:G:C"}]}'
```
Expected excerpt:
```json
{"scored_variants":[{"variant_id":"v1","alphamissense_score":0.978,"esm_score":-999.0,"zeta_score":0.978}]}
```
- Evo2 backend sanity check (BRAF V600E):
```bash
curl -sS -X POST http://127.0.0.1:8000/api/evo/score_variant_multi \
  -H 'Content-Type: application/json' \
  -d '{"assembly":"GRCh38","chrom":"7","pos":140453136,"ref":"T","alt":"A","model_id":"evo2_7b"}'
```
Expected excerpt:
```json
{"min_delta":-9.310245513916016e-05,"provenance":{"method":"mapped_score_delta","model":"evo2_7b","flank":4096}}
```
- AM‑covered micro eval (20 variants: 10 high AM, 10 low AM):
```json
{"crisrPRO_only":{"auroc":0.83,"auprc":0.8253,"n":20}}
{"am_only":{"auroc":1.0,"auprc":1.0,"n":20}}
{"fused_max":{"auroc":1.0,"auprc":1.0,"n":20}}
```
- AM‑covered 50/50 eval (100 variants):
```json
{"crisrPRO_only":{"auroc":0.9456,"auprc":0.9499,"n":100}}
{"am_only":{"auroc":1.0,"auprc":1.0,"n":100}}
{"fused_max":{"auroc":1.0,"auprc":1.0,"n":100}}
```

### What this means for MM, chemotherapy, and clinical guidance
- For MM and other indications, our guidance pipelines consume a sequence signal “S.” The Fusion Engine upgrades S:
  - If AM is available (coding SNV with AM coverage), fused S (Evo2+AM) significantly lifts accuracy and confidence.
  - When AM is not available (noncoding, indels, less common SNVs), we default to Evo2 S with clear provenance and conservative confidence.
- Front‑to‑back alignment:
  - Guidance endpoints (chemo, radonc, synthetic lethality) already read efficacy outputs that depend on S. See [guidance.py](mdc:oncology-coPilot/oncology-backend-minimal/api/routers/guidance.py) and [efficacy.py](mdc:oncology-coPilot/oncology-backend-minimal/api/routers/efficacy.py).
  - We can elevate tiers or confidence modestly when fused S is strong, preserving transparency and auditability.

#### How fused S increases confidence (by how much, and when)
- In our guidance engine, “S” feeds efficacy alongside Pathway (P) and Evidence (E). We apply modest, transparent boosts when S exceeds thresholds:
  - Example thresholds (illustrative): if fused S ≥0.90 and MoA alignment is present, confidence +0.05 and tier may upgrade from Consider → Supported.
  - Provenance records which source (Evo2 vs AM) drove the fused S, plus raw values, so clinicians can audit why a call was made.
- For MM chemotherapy classes (e.g., proteasome inhibitor, IMiD, anti‑CD38): strong fused S in genes tied to the class’s biology increases the probability that the class is truly relevant, making rank‑ordering more reliable.

#### Practical inputs/outputs for partners
- Input (MM example): list of variants with gene and coordinates; optional disease and candidate drug classes.
- Output: for each candidate class, an efficacy_score, confidence, evidence_tier, and insights, with `provenance.s.sequence = { evo2, am, fused }` fields so teams can see the exact components.

### Partner‑focused digest: why this matters for biotech and clinics
- **Higher signal, same transparency:** Fusing a curated prior (AM) with Evo2’s general sequence model increases accuracy on covered missense SNVs without turning the system into a black box.
- **Actionable guidance:** Elevated and justified confidence scores translate into clearer Tier I/II recommendations—with citations and MoA alignment—speeding trials, IND packages, and patient stratification.
- **Operational fit:** The Fusion Engine runs as a lightweight Modal service; if the Parquet is mounted, responses are sub‑second. When coverage is absent, we fall back cleanly to Evo2.
- **Trust by design:** Every recommendation carries source attribution (Evo2/AM), raw values, and thresholds used, enabling institutional review boards and clinical teams to audit decisions.

### Differentiators – why CrisPRO is different
- **Fused, not single‑source:** Most tools give either a general sequence score (unsupervised) or a catalog prior. We fuse both. On AM‑covered missense SNVs we reach ≥90% AUROC (often ~1.0 on curated sets), while preserving fallback and provenance elsewhere.
- **Provenance everywhere:** Outputs include `sequence = { evo2, am, fused }`, MoA tags, literature badges, thresholds, and decision gates—so partners can see exactly why a call was made.
- **Guidance‑ready, not just scores:** The fused S flows into efficacy and clinical guidance (chemo/radonc) with modest, auditable lifts; we never “jump tiers” without gates (MoA, evidence) supporting the change.
- **Selective lift, conservative defaults:** Outside AM coverage (indels, noncoding), we rely on Evo2 S and literature—no silent extrapolation. This avoids false confidence and keeps regulators comfortable.
- **Operational pragmatism:** Modal microservices + local Parquet support make integration straightforward in both research and clinical pipelines.

### What this means in practice (for MM and beyond)
- **Missense SNVs in MM (KRAS/NRAS/BRAF/TP53/FGFR3):** When AM covers the variant, fused S increases confidence in pathway‑aligned drug classes (e.g., BRAF/MEK for MAPK‑driven cases). Off‑label hypotheses become clearer and more defensible with explicit provenance.
- **Chemo guidance:** For proteasome inhibitors, IMiDs, anti‑CD38, fused S in driver genes contributes to confidence alongside pathway and literature—making rank‑ordering more clinically meaningful.
- **Roll‑out strategy:** Start with fused S for coding missense SNVs; maintain Evo2+literature for non‑covered contexts; add conservation/hotspots next to expand high‑confidence coverage.

### Drug efficacy context – how to interpret the numbers
- **Sequence (S):** Probability that the variant disrupts function; fused S ≥0.90 indicates strong disruption on covered missense SNVs.
- **Pathway (P):** Does the disrupted gene connect to the drug’s MoA (e.g., MAPK pathway for BRAF/MEK)? If yes, guidance can lift.
- **Evidence (E):** Literature and clinical evidence (badges) remain independent gates. High S without E → cautious “Consider”; high S + MoA + E → “Supported”.
- **Confidence:** Slight, transparent boosts when S is strong and aligned with P/E; provenance shows the exact trigger (e.g., `confidence_lift: +0.05 due to fused S ≥0.90 + MoA`).

### Why the earlier random‑set scores were lower
- Zero‑shot Evo2 is a general sequence model (strong but unsupervised). Random, mixed coverage ClinVar sets yield ~0.6 AUROC locally.
- Stacking with AM transforms performance on covered coding SNVs: fused S→ ≥0.9 AUROC. Both realities are true; we disclose context clearly.

### Implications for biotech and clinical partners
- **Trust and provenance:** Every score carries source tags (Evo2/AM) and URLs for replication. No opaque magic.
- **Actionability:** Strong fused S feeds our guidance gates; decisions (Yes/Consider/Insufficient) are backed by clear signals and literature.
- **Scalability:** Modal services let us serve curated priors (AM) at scale; Evo2 handles breadth. Together, they raise precision without sacrificing coverage.

### How to adopt the fused signal in guidance (quick path)
1) Keep Evo2 S calls unchanged in efficacy.
2) Add an AM lookup step:
   - Local Parquet via [src/tools/alphamissense_client.py](mdc:src/tools/alphamissense_client.py) with `ALPHAMISSENSE_DATA`, or
   - HTTP fallback via Fusion Engine URL `FUSION_AM_URL`.
3) Fuse S per variant: `fused = max(|Evo2|, AM)` or a calibrated head; attach provenance.
4) Slightly lift tier/confidence only when fused S is strong and evidence gates allow.

#### Example request/response (chemo guidance)
- Request (snippet):
```json
{
  "disease": "multiple myeloma",
  "drug_or_class": "Proteasome inhibitor",
  "mutations": [
    {"gene":"TP53","chrom":"17","pos":7676150,"ref":"C","alt":"T","hgvs_p":"R248W"}
  ],
  "api_base":"http://127.0.0.1:8000"
}
```
- Response (snippet):
```json
{
  "therapy":"Proteasome inhibitor",
  "efficacy_score":0.31,
  "confidence":0.58,
  "evidence_tier":"supported",
  "insights": {"sequence": {"evo2": 0.27, "am": 0.93, "fused": 0.93}, "pathway": 0.41, "evidence": 0.62},
  "provenance": {"sequence": {"method":"fused_max", "model":"evo2_7b", "am_source":"fusion_engine"}}
}
```

### Roadmap and safeguards
- Extend fused coverage with conservation and hotspot/domain features.
- Maintain GroupKFold by gene + isotonic calibration for supervised heads.
- Keep AM gating explicit; never silently extrapolate outside covered contexts.

### Appendix – commands and files
- Evo2 proxy/router: [evo.py](mdc:oncology-coPilot/oncology-backend-minimal/api/routers/evo.py)
- Efficacy orchestrator: [efficacy.py](mdc:oncology-coPilot/oncology-backend-minimal/api/routers/efficacy.py)
- Guidance endpoints: [guidance.py](mdc:oncology-coPilot/oncology-backend-minimal/api/routers/guidance.py)
- Variant AUROC bench: [tools/benchmarks/variant_auroc.py](mdc:tools/benchmarks/variant_auroc.py)
- Fused micro eval: [tools/benchmarks/eval_fused_micro.py](mdc:tools/benchmarks/eval_fused_micro.py)
- AM sampler: [src/tools/sample_am_variants.py](mdc:src/tools/sample_am_variants.py)
- Fusion Engine service: [src/services/fusion_engine/main.py](mdc:src/services/fusion_engine/main.py)

