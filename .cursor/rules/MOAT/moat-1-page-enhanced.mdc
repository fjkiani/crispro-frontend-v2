import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { 
    Shield, ArrowRight, ArrowLeft, Users, Target, TrendingUp,
    Pill, Dna, Clock, CheckCircle, XCircle, Beaker, Activity,
    ChevronRight, Zap, Heart, Brain, Layers, Database, AlertTriangle,
    BarChart3, GitBranch, FlaskConical, Microscope, Radio, Gauge
} from 'lucide-react';

//================================================================================
// SLIDE NAVIGATION
//================================================================================

const SlideNav = ({ current, total, onPrev, onNext }) => (
    <div className="fixed bottom-8 left-1/2 -translate-x-1/2 flex items-center gap-6 z-50">
        <button 
            onClick={onPrev}
            disabled={current === 0}
            className="p-3 rounded-full bg-slate-800/80 border border-slate-600 hover:border-cyan-500 disabled:opacity-30 disabled:cursor-not-allowed transition-all"
        >
            <ArrowLeft className="w-5 h-5 text-white"/>
        </button>
        
        <div className="flex gap-2">
            {Array.from({length: total}).map((_, i) => (
                <div 
                    key={i} 
                    className={`w-2 h-2 rounded-full transition-all ${
                        i === current ? 'bg-cyan-400 w-8' : 'bg-slate-600'
                    }`}
                />
            ))}
        </div>
        
        <button 
            onClick={onNext}
            disabled={current === total - 1}
            className="p-3 rounded-full bg-slate-800/80 border border-slate-600 hover:border-cyan-500 disabled:opacity-30 disabled:cursor-not-allowed transition-all"
        >
            <ArrowRight className="w-5 h-5 text-white"/>
        </button>
    </div>
);

//================================================================================
// SLIDE 1: HERO
//================================================================================

const HeroSlide = () => (
    <div className="h-full flex flex-col items-center justify-center text-center px-8">
        <motion.div
            initial={{ opacity: 0, y: 30 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.6 }}
        >
            <p className="text-cyan-400 text-xl font-semibold tracking-wider mb-4">
                THREE QUESTIONS. ZERO GENERIC ANSWERS.
            </p>
            <h1 className="text-6xl md:text-8xl font-black text-white leading-tight">
                Precision Oncology<br/>
                <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-500">
                    That Actually Is
                </span>
            </h1>
        </motion.div>
        
        <motion.div 
            className="mt-16 flex flex-col md:flex-row gap-6"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.4 }}
        >
            {[
                { q: "What should I eat?", icon: Beaker, color: "cyan" },
                { q: "Will I become resistant?", icon: TrendingUp, color: "purple" },
                { q: "Does this work for me?", icon: Target, color: "emerald" }
            ].map((item, i) => (
                <div key={i} className="flex items-center gap-3 px-6 py-4 bg-slate-800/50 border border-slate-700 rounded-xl">
                    <item.icon className="w-6 h-6 text-cyan-400"/>
                    <span className="text-lg text-white font-medium">{item.q}</span>
                </div>
            ))}
        </motion.div>
        
        <motion.div 
            className="mt-12 grid grid-cols-4 gap-6"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.6 }}
        >
            {[
                { value: "469", label: "Patients Validated" },
                { value: "100%", label: "Top-5 Accuracy" },
                { value: "1.97×", label: "Resistance RR" },
                { value: "7D", label: "Mechanism Vector" }
            ].map((item, i) => (
                <div key={i} className="text-center">
                    <p className="text-3xl font-black text-white">{item.value}</p>
                    <p className="text-sm text-slate-400">{item.label}</p>
                </div>
            ))}
        </motion.div>
    </div>
);

//================================================================================
// SLIDE 2: RESISTANCE PREDICTION - THE PROBLEM
//================================================================================

const ResistanceProblemSlide = () => (
    <div className="h-full flex flex-col justify-center px-8">
        <motion.div 
            className="text-center mb-8"
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
        >
            <div className="inline-flex items-center gap-2 px-4 py-2 bg-purple-500/10 border border-purple-500/30 rounded-full mb-4">
                <TrendingUp className="w-5 h-5 text-purple-400"/>
                <span className="text-purple-300 font-semibold">RESISTANCE PREDICTION MOAT</span>
            </div>
            <h2 className="text-5xl font-black text-white">
                The Problem We Solved
            </h2>
        </motion.div>
        
        <motion.div 
            className="grid md:grid-cols-2 gap-8 max-w-6xl mx-auto"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
        >
            {/* Before */}
            <div className="p-8 bg-red-500/5 border border-red-500/30 rounded-2xl">
                <div className="flex items-center gap-3 mb-6">
                    <XCircle className="w-8 h-8 text-red-400"/>
                    <h3 className="text-2xl font-bold text-red-300">Before</h3>
                </div>
                
                <div className="space-y-4">
                    <div className="p-4 bg-red-500/10 rounded-xl">
                        <p className="text-slate-300 italic">"We'll monitor and see."</p>
                    </div>
                    <div className="space-y-2 text-slate-400">
                        <p>❌ No upfront resistance prediction</p>
                        <p>❌ Resistance detected AFTER progression</p>
                        <p>❌ No actionable markers</p>
                        <p>❌ Same treatment for all patients</p>
                    </div>
                </div>
            </div>
            
            {/* After */}
            <div className="p-8 bg-purple-500/5 border border-purple-500/30 rounded-2xl">
                <div className="flex items-center gap-3 mb-6">
                    <CheckCircle className="w-8 h-8 text-purple-400"/>
                    <h3 className="text-2xl font-bold text-purple-300">After</h3>
                </div>
                
                <div className="space-y-4">
                    <div className="p-4 bg-purple-500/10 rounded-xl">
                        <p className="text-white font-medium">"Your MAPK mutation = 2× resistance risk. Here's your action plan."</p>
                    </div>
                    <div className="space-y-2 text-slate-300">
                        <p>✅ Predict resistance UPFRONT</p>
                        <p>✅ Pathway-based mechanism analysis</p>
                        <p>✅ Actionable recommendations</p>
                        <p>✅ Personalized monitoring schedule</p>
                    </div>
                </div>
            </div>
        </motion.div>
        
        <motion.div 
            className="mt-8 text-center"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.6 }}
        >
            <p className="text-xl text-slate-400">
                Validated on <span className="text-white font-bold">469 TCGA ovarian cancer patients</span> with platinum response data
            </p>
        </motion.div>
    </div>
);

//================================================================================
// SLIDE 3: THE TECHNICAL ARCHITECTURE
//================================================================================

const TechnicalArchitectureSlide = () => (
    <div className="h-full flex flex-col justify-center px-8 overflow-y-auto py-8">
        <motion.div 
            className="text-center mb-8"
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
        >
            <h2 className="text-4xl font-black text-white mb-2">
                Technical Architecture
            </h2>
            <p className="text-slate-400">From mutations to resistance prediction</p>
        </motion.div>
        
        {/* Architecture Flow */}
        <motion.div 
            className="max-w-6xl mx-auto"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
        >
            {/* Row 1: Input */}
            <div className="flex items-center justify-center gap-4 mb-6">
                <div className="p-6 bg-slate-800/50 border border-slate-700 rounded-2xl text-center w-64">
                    <Dna className="w-10 h-10 text-pink-400 mx-auto mb-2"/>
                    <p className="text-white font-bold">Patient Mutations</p>
                    <p className="text-xs text-slate-400">MBD4, TP53, KRAS, NF1...</p>
                </div>
                <ChevronRight className="w-6 h-6 text-cyan-400"/>
                <div className="p-6 bg-slate-800/50 border border-slate-700 rounded-2xl text-center w-64">
                    <FlaskConical className="w-10 h-10 text-cyan-400 mx-auto mb-2"/>
                    <p className="text-white font-bold">Biomarkers</p>
                    <p className="text-xs text-slate-400">TMB, MSI, HRD Score</p>
                </div>
            </div>
            
            {/* Arrow Down */}
            <div className="flex justify-center mb-6">
                <ArrowRight className="w-6 h-6 text-purple-400 rotate-90"/>
            </div>
            
            {/* Row 2: Processing */}
            <div className="grid grid-cols-3 gap-4 mb-6">
                <div className="p-5 bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/30 rounded-2xl">
                    <div className="flex items-center gap-2 mb-3">
                        <Brain className="w-6 h-6 text-cyan-400"/>
                        <span className="text-cyan-300 font-bold">S: Sequence</span>
                    </div>
                    <p className="text-xs text-slate-300">Evo2 7B variant scoring</p>
                    <p className="text-xs text-slate-400 mt-1">32K SAE features from Layer 26</p>
                    <div className="mt-2 p-2 bg-slate-900/50 rounded text-xs font-mono text-cyan-300">
                        sequence_disruption: 0.85
                    </div>
                </div>
                
                <div className="p-5 bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/30 rounded-2xl">
                    <div className="flex items-center gap-2 mb-3">
                        <Layers className="w-6 h-6 text-purple-400"/>
                        <span className="text-purple-300 font-bold">P: Pathway</span>
                    </div>
                    <p className="text-xs text-slate-300">Gene → Pathway aggregation</p>
                    <p className="text-xs text-slate-400 mt-1">7D mechanism vector</p>
                    <div className="mt-2 p-2 bg-slate-900/50 rounded text-xs font-mono text-purple-300">
                        pathway_burden: [0.88, 0.12, ...]
                    </div>
                </div>
                
                <div className="p-5 bg-gradient-to-br from-emerald-500/10 to-teal-500/10 border border-emerald-500/30 rounded-2xl">
                    <div className="flex items-center gap-2 mb-3">
                        <Database className="w-6 h-6 text-emerald-400"/>
                        <span className="text-emerald-300 font-bold">E: Evidence</span>
                    </div>
                    <p className="text-xs text-slate-300">ClinVar + Literature</p>
                    <p className="text-xs text-slate-400 mt-1">Trial matching</p>
                    <div className="mt-2 p-2 bg-slate-900/50 rounded text-xs font-mono text-emerald-300">
                        evidence_tier: "Tier_1"
                    </div>
                </div>
            </div>
            
            {/* Arrow Down */}
            <div className="flex justify-center mb-6">
                <ArrowRight className="w-6 h-6 text-purple-400 rotate-90"/>
            </div>
            
            {/* Row 3: Output */}
            <div className="p-6 bg-gradient-to-r from-purple-500/10 to-cyan-500/10 border border-purple-500/30 rounded-2xl max-w-2xl mx-auto">
                <div className="flex items-center justify-center gap-3 mb-4">
                    <TrendingUp className="w-8 h-8 text-purple-400"/>
                    <span className="text-2xl font-black text-white">Resistance Prophet Service</span>
                </div>
                <div className="grid grid-cols-3 gap-4 text-center">
                    <div>
                        <p className="text-2xl font-bold text-red-400">HIGH</p>
                        <p className="text-xs text-slate-400">Risk Level</p>
                    </div>
                    <div>
                        <p className="text-2xl font-bold text-purple-400">1.97×</p>
                        <p className="text-xs text-slate-400">Relative Risk</p>
                    </div>
                    <div>
                        <p className="text-2xl font-bold text-cyan-400">2/3</p>
                        <p className="text-xs text-slate-400">Signals Triggered</p>
                    </div>
                </div>
            </div>
        </motion.div>
        
        <motion.p 
            className="text-center mt-6 text-sm text-slate-400"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.8 }}
        >
            <span className="text-cyan-400 font-mono">efficacy_score = 0.3×S + 0.4×P + 0.3×E</span>
        </motion.p>
    </div>
);

//================================================================================
// SLIDE 4: 7D MECHANISM VECTOR
//================================================================================

const MechanismVectorSlide = () => (
    <div className="h-full flex flex-col justify-center px-8 overflow-y-auto py-8">
        <motion.div 
            className="text-center mb-8"
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
        >
            <h2 className="text-4xl font-black text-white mb-2">
                7D Mechanism Vector
            </h2>
            <p className="text-slate-400">Patient pathway burden → Mechanism alignment</p>
        </motion.div>
        
        {/* 7D Vector Visualization */}
        <motion.div 
            className="max-w-5xl mx-auto mb-8"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
        >
            <div className="grid grid-cols-7 gap-3">
                {[
                    { name: "DDR", value: 0.88, desc: "DNA Damage Response", genes: "BRCA1/2, MBD4, ATM, TP53", color: "#ef4444" },
                    { name: "MAPK", value: 0.12, desc: "RAS/RAF/MEK Pathway", genes: "KRAS, NRAS, BRAF, NF1", color: "#f97316" },
                    { name: "PI3K", value: 0.15, desc: "PI3K/AKT/mTOR", genes: "PIK3CA, PTEN, AKT1", color: "#eab308" },
                    { name: "VEGF", value: 0.20, desc: "Angiogenesis", genes: "VEGFA, VHL", color: "#22c55e" },
                    { name: "HER2", value: 0.05, desc: "HER2 Amplification", genes: "ERBB2", color: "#06b6d4" },
                    { name: "IO", value: 0.80, desc: "Immunotherapy", genes: "TMB≥20 or MSI-H", color: "#8b5cf6" },
                    { name: "Efflux", value: 0.10, desc: "Drug Efflux Pumps", genes: "ABCB1", color: "#64748b" }
                ].map((pathway, i) => (
                    <motion.div 
                        key={i}
                        className="p-4 bg-slate-800/50 border border-slate-700 rounded-xl text-center"
                        initial={{ opacity: 0, y: 20 }}
                        animate={{ opacity: 1, y: 0 }}
                        transition={{ delay: 0.4 + i * 0.1 }}
                    >
                        <p className="text-xs text-slate-400 mb-2">{pathway.name}</p>
                        <div className="relative h-24 bg-slate-700 rounded-lg overflow-hidden mb-2">
                            <motion.div 
                                className="absolute bottom-0 w-full rounded-lg"
                                style={{ backgroundColor: pathway.color }}
                                initial={{ height: 0 }}
                                animate={{ height: `${pathway.value * 100}%` }}
                                transition={{ delay: 0.6 + i * 0.1, duration: 0.5 }}
                            />
                            <div className="absolute inset-0 flex items-center justify-center">
                                <span className="text-lg font-black text-white drop-shadow">{pathway.value.toFixed(2)}</span>
                            </div>
                        </div>
                        <p className="text-[10px] text-slate-500 leading-tight">{pathway.desc}</p>
                    </motion.div>
                ))}
            </div>
        </motion.div>
        
        {/* Formula */}
        <motion.div 
            className="max-w-4xl mx-auto p-6 bg-slate-800/50 border border-slate-700 rounded-2xl"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.9 }}
        >
            <h3 className="text-lg font-bold text-white mb-4">How It's Computed</h3>
            <div className="grid md:grid-cols-2 gap-6">
                <div>
                    <p className="text-sm text-slate-300 mb-2">From Patient Mutations:</p>
                    <div className="p-3 bg-slate-900/50 rounded-lg font-mono text-xs">
                        <p className="text-cyan-300">DDR = MBD4(0.35) + TP53(0.35) + ATM(0.35)</p>
                        <p className="text-purple-300 mt-1">IO = 1.0 if (TMB≥20 OR MSI-H) else 0.0</p>
                        <p className="text-pink-300 mt-1">MAPK = KRAS(0.40) + NF1(0.40) + BRAF(0.40)</p>
                    </div>
                </div>
                <div>
                    <p className="text-sm text-slate-300 mb-2">For Trial Matching:</p>
                    <div className="p-3 bg-slate-900/50 rounded-lg font-mono text-xs">
                        <p className="text-emerald-300">mechanism_fit = cosine_similarity(</p>
                        <p className="text-emerald-300 ml-4">patient_vector,</p>
                        <p className="text-emerald-300 ml-4">trial_moa_vector</p>
                        <p className="text-emerald-300">)</p>
                    </div>
                </div>
            </div>
        </motion.div>
        
        <motion.p 
            className="text-center mt-4 text-sm text-purple-400"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 1.1 }}
        >
            DDR = 0.88 → High DNA repair pathway burden → PARP inhibitor trials rank higher
        </motion.p>
    </div>
);

//================================================================================
// SLIDE 5: SAE FEATURE EXTRACTION
//================================================================================

const SAESlide = () => (
    <div className="h-full flex flex-col justify-center px-8 overflow-y-auto py-8">
        <motion.div 
            className="text-center mb-8"
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
        >
            <h2 className="text-4xl font-black text-white mb-2">
                SAE: Sparse AutoEncoder
            </h2>
            <p className="text-slate-400">Interpretable features from Evo2's internal representations</p>
        </motion.div>
        
        {/* SAE Pipeline */}
        <motion.div 
            className="max-w-5xl mx-auto"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
        >
            {/* Pipeline Steps */}
            <div className="flex items-center justify-center gap-2 mb-8">
                {[
                    { icon: Dna, label: "Variant", detail: "DNA sequence" },
                    { icon: Brain, label: "Evo2 7B", detail: "Layer 26 activations" },
                    { icon: Layers, label: "SAE", detail: "BatchTopKTiedSAE" },
                    { icon: BarChart3, label: "32K Features", detail: "Top K=64 active" }
                ].map((step, i) => (
                    <React.Fragment key={i}>
                        <motion.div 
                            className="p-4 bg-slate-800/50 border border-slate-700 rounded-xl text-center w-36"
                            initial={{ opacity: 0, scale: 0.8 }}
                            animate={{ opacity: 1, scale: 1 }}
                            transition={{ delay: 0.4 + i * 0.15 }}
                        >
                            <step.icon className="w-8 h-8 text-cyan-400 mx-auto mb-2"/>
                            <p className="text-white font-bold text-sm">{step.label}</p>
                            <p className="text-xs text-slate-400">{step.detail}</p>
                        </motion.div>
                        {i < 3 && <ChevronRight className="w-5 h-5 text-purple-400 flex-shrink-0"/>}
                    </React.Fragment>
                ))}
            </div>
            
            {/* Technical Details */}
            <div className="grid md:grid-cols-2 gap-6 mb-8">
                <div className="p-6 bg-slate-800/50 border border-slate-700 rounded-2xl">
                    <h3 className="text-lg font-bold text-white mb-4 flex items-center gap-2">
                        <Brain className="w-5 h-5 text-cyan-400"/>
                        SAE Architecture
                    </h3>
                    <div className="space-y-2 text-sm">
                        <div className="flex justify-between">
                            <span className="text-slate-400">Type</span>
                            <span className="text-cyan-300 font-mono">BatchTopKTiedSAE</span>
                        </div>
                        <div className="flex justify-between">
                            <span className="text-slate-400">Input</span>
                            <span className="text-cyan-300 font-mono">4096-dim (Evo2 L26)</span>
                        </div>
                        <div className="flex justify-between">
                            <span className="text-slate-400">Output</span>
                            <span className="text-cyan-300 font-mono">32,768 sparse features</span>
                        </div>
                        <div className="flex justify-between">
                            <span className="text-slate-400">Active per sample</span>
                            <span className="text-cyan-300 font-mono">Top K=64</span>
                        </div>
                        <div className="flex justify-between">
                            <span className="text-slate-400">Checkpoint</span>
                            <span className="text-cyan-300 font-mono text-xs">Goodfire/Evo-2-Layer-26</span>
                        </div>
                    </div>
                </div>
                
                <div className="p-6 bg-slate-800/50 border border-slate-700 rounded-2xl">
                    <h3 className="text-lg font-bold text-white mb-4 flex items-center gap-2">
                        <Database className="w-5 h-5 text-purple-400"/>
                        Extraction Status
                    </h3>
                    <div className="space-y-2 text-sm">
                        <div className="flex justify-between">
                            <span className="text-slate-400">Patients Extracted</span>
                            <span className="text-green-400 font-bold">66 ✓</span>
                        </div>
                        <div className="flex justify-between">
                            <span className="text-slate-400">Variants Processed</span>
                            <span className="text-green-400 font-bold">2,897 ✓</span>
                        </div>
                        <div className="flex justify-between">
                            <span className="text-slate-400">TRUE SAE</span>
                            <span className="text-green-400 font-bold">Operational ✓</span>
                        </div>
                        <div className="flex justify-between">
                            <span className="text-slate-400">Proxy Fallback</span>
                            <span className="text-yellow-400">Gene→Pathway</span>
                        </div>
                        <div className="flex justify-between">
                            <span className="text-slate-400">Modal Service</span>
                            <span className="text-green-400">Running ✓</span>
                        </div>
                    </div>
                </div>
            </div>
            
            {/* SAE → Pathway */}
            <div className="p-6 bg-gradient-to-r from-purple-500/10 to-cyan-500/10 border border-purple-500/30 rounded-2xl">
                <h3 className="text-lg font-bold text-white mb-4 text-center">SAE → 7D Mechanism Vector</h3>
                <div className="flex items-center justify-center gap-4">
                    <div className="text-center">
                        <p className="text-3xl font-mono text-cyan-400">32,768</p>
                        <p className="text-xs text-slate-400">SAE Features</p>
                    </div>
                    <div className="flex flex-col items-center">
                        <ChevronRight className="w-8 h-8 text-purple-400"/>
                        <span className="text-xs text-slate-400">Feature→Pathway</span>
                        <span className="text-xs text-slate-400">Mapping</span>
                    </div>
                    <div className="text-center">
                        <p className="text-3xl font-mono text-purple-400">7D</p>
                        <p className="text-xs text-slate-400">Mechanism Vector</p>
                    </div>
                    <div className="flex flex-col items-center">
                        <ChevronRight className="w-8 h-8 text-purple-400"/>
                        <span className="text-xs text-slate-400">Cosine</span>
                        <span className="text-xs text-slate-400">Similarity</span>
                    </div>
                    <div className="text-center">
                        <p className="text-3xl font-mono text-emerald-400">0.92</p>
                        <p className="text-xs text-slate-400">Mechanism Fit</p>
                    </div>
                </div>
            </div>
        </motion.div>
    </div>
);

//================================================================================
// SLIDE 6: RESISTANCE PROPHET SERVICE
//================================================================================

const ResistanceProphetSlide = () => (
    <div className="h-full flex flex-col justify-center px-8 overflow-y-auto py-8">
        <motion.div 
            className="text-center mb-8"
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
        >
            <h2 className="text-4xl font-black text-white mb-2">
                Resistance Prophet Service
            </h2>
            <p className="text-slate-400">2-of-3 signal detection for early resistance warning</p>
        </motion.div>
        
        {/* 3 Signals */}
        <motion.div 
            className="grid md:grid-cols-3 gap-6 max-w-5xl mx-auto mb-8"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
        >
            {[
                {
                    icon: Dna,
                    signal: "Signal 1",
                    name: "DNA Repair Restoration",
                    description: "DNA repair capacity drops from baseline",
                    threshold: "ΔDR < -0.15",
                    detail: "DDR pathway change: -0.23",
                    color: "cyan"
                },
                {
                    icon: GitBranch,
                    signal: "Signal 2",
                    name: "Pathway Escape",
                    description: "Tumor bypasses targeted pathway",
                    threshold: "Pathway drop < -0.15",
                    detail: "DDR bypass detected",
                    color: "purple"
                },
                {
                    icon: Activity,
                    signal: "Signal 3",
                    name: "CA-125 Kinetics",
                    description: "Biomarker rising or inadequate drop",
                    threshold: "CA-125 inadequate decline",
                    detail: "Phase 1b+ only",
                    color: "pink"
                }
            ].map((signal, i) => (
                <motion.div 
                    key={i}
                    className={`p-6 bg-${signal.color}-500/5 border border-${signal.color}-500/30 rounded-2xl`}
                    style={{
                        backgroundColor: signal.color === 'cyan' ? 'rgba(34, 211, 238, 0.05)' : 
                                        signal.color === 'purple' ? 'rgba(168, 85, 247, 0.05)' : 
                                        'rgba(236, 72, 153, 0.05)',
                        borderColor: signal.color === 'cyan' ? 'rgba(34, 211, 238, 0.3)' : 
                                    signal.color === 'purple' ? 'rgba(168, 85, 247, 0.3)' : 
                                    'rgba(236, 72, 153, 0.3)'
                    }}
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ delay: 0.4 + i * 0.15 }}
                >
                    <div className="flex items-center gap-3 mb-4">
                        <signal.icon 
                            className="w-8 h-8"
                            style={{ color: signal.color === 'cyan' ? '#22d3ee' : 
                                           signal.color === 'purple' ? '#a855f7' : '#ec4899' }}
                        />
                        <div>
                            <p className="text-xs text-slate-400">{signal.signal}</p>
                            <p className="text-white font-bold">{signal.name}</p>
                        </div>
                    </div>
                    <p className="text-sm text-slate-300 mb-3">{signal.description}</p>
                    <div className="p-2 bg-slate-900/50 rounded text-xs font-mono mb-2"
                         style={{ color: signal.color === 'cyan' ? '#22d3ee' : 
                                        signal.color === 'purple' ? '#a855f7' : '#ec4899' }}>
                        {signal.threshold}
                    </div>
                    <p className="text-xs text-slate-500">{signal.detail}</p>
                </motion.div>
            ))}
        </motion.div>
        
        {/* Rule */}
        <motion.div 
            className="max-w-3xl mx-auto p-6 bg-red-500/10 border border-red-500/30 rounded-2xl text-center"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.8 }}
        >
            <div className="flex items-center justify-center gap-4 mb-4">
                <AlertTriangle className="w-8 h-8 text-red-400"/>
                <span className="text-2xl font-black text-white">2-of-3 Rule</span>
            </div>
            <p className="text-slate-300 mb-4">
                If <span className="text-red-400 font-bold">≥2 signals</span> detected + 
                <span className="text-red-400 font-bold"> probability ≥0.70</span> → 
                <span className="text-red-400 font-bold"> HIGH RISK</span>
            </p>
            <div className="grid grid-cols-3 gap-4 text-center">
                <div className="p-3 bg-slate-900/50 rounded-lg">
                    <p className="text-xl font-bold text-red-400">HIGH</p>
                    <p className="text-xs text-slate-400">≥2 signals + prob ≥0.70</p>
                </div>
                <div className="p-3 bg-slate-900/50 rounded-lg">
                    <p className="text-xl font-bold text-yellow-400">MEDIUM</p>
                    <p className="text-xs text-slate-400">1 signal OR prob 0.50-0.70</p>
                </div>
                <div className="p-3 bg-slate-900/50 rounded-lg">
                    <p className="text-xl font-bold text-green-400">LOW</p>
                    <p className="text-xs text-slate-400">0 signals + prob &lt;0.50</p>
                </div>
            </div>
        </motion.div>
    </div>
);

//================================================================================
// SLIDE 7: MAPK VALIDATION RESULTS
//================================================================================

const ValidationSlide = () => (
    <div className="h-full flex flex-col justify-center px-8">
        <motion.div 
            className="text-center mb-8"
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
        >
            <h2 className="text-4xl font-black text-white mb-2">
                Validation Results
            </h2>
            <p className="text-slate-400">469 TCGA ovarian cancer patients with platinum response</p>
        </motion.div>
        
        {/* Validation Data */}
        <motion.div 
            className="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
        >
            {/* MAPK Results */}
            <div className="p-8 bg-slate-800/50 border border-slate-700 rounded-2xl">
                <h3 className="text-2xl font-bold text-white mb-6 flex items-center gap-2">
                    <BarChart3 className="w-6 h-6 text-purple-400"/>
                    MAPK/NF1 Mutations
                </h3>
                
                <div className="space-y-6">
                    <div>
                        <div className="flex justify-between mb-2">
                            <span className="text-slate-300">With MAPK mutation</span>
                            <span className="text-red-400 font-bold">28.6% resistant</span>
                        </div>
                        <div className="h-6 bg-slate-700 rounded-full overflow-hidden">
                            <motion.div 
                                className="h-full bg-gradient-to-r from-red-500 to-red-400 rounded-full flex items-center justify-end pr-2"
                                initial={{ width: 0 }}
                                animate={{ width: '28.6%' }}
                                transition={{ delay: 0.5, duration: 0.8 }}
                            >
                                <span className="text-xs text-white font-bold">10/35</span>
                            </motion.div>
                        </div>
                    </div>
                    
                    <div>
                        <div className="flex justify-between mb-2">
                            <span className="text-slate-300">Without mutation</span>
                            <span className="text-green-400 font-bold">14.5% resistant</span>
                        </div>
                        <div className="h-6 bg-slate-700 rounded-full overflow-hidden">
                            <motion.div 
                                className="h-full bg-gradient-to-r from-green-500 to-green-400 rounded-full flex items-center justify-end pr-2"
                                initial={{ width: 0 }}
                                animate={{ width: '14.5%' }}
                                transition={{ delay: 0.7, duration: 0.8 }}
                            >
                                <span className="text-xs text-white font-bold">63/434</span>
                            </motion.div>
                        </div>
                    </div>
                </div>
                
                <div className="mt-8 p-4 bg-purple-500/10 border border-purple-500/30 rounded-xl text-center">
                    <p className="text-5xl font-black text-purple-400">1.97×</p>
                    <p className="text-slate-300">Relative Risk</p>
                </div>
            </div>
            
            {/* MAPK Genes */}
            <div className="p-8 bg-gradient-to-br from-purple-500/10 to-cyan-500/10 border border-purple-500/30 rounded-2xl">
                <h3 className="text-2xl font-bold text-white mb-6">MAPK Pathway Genes</h3>
                
                <div className="grid grid-cols-2 gap-4 mb-6">
                    {['KRAS', 'NRAS', 'BRAF', 'NF1', 'MAP2K1', 'MAP2K2'].map((gene, i) => (
                        <motion.div 
                            key={i}
                            className="p-4 bg-slate-800/50 rounded-xl text-center"
                            initial={{ opacity: 0, scale: 0.8 }}
                            animate={{ opacity: 1, scale: 1 }}
                            transition={{ delay: 0.8 + i * 0.1 }}
                        >
                            <p className="text-xl font-bold text-white">{gene}</p>
                            <p className="text-xs text-slate-400">Signal transducer</p>
                        </motion.div>
                    ))}
                </div>
                
                <div className="space-y-2">
                    <div className="flex items-center gap-2 p-2 bg-green-500/10 rounded">
                        <CheckCircle className="w-4 h-4 text-green-400"/>
                        <span className="text-sm text-green-300">p &lt; 0.05 (statistically significant)</span>
                    </div>
                    <div className="flex items-center gap-2 p-2 bg-green-500/10 rounded">
                        <CheckCircle className="w-4 h-4 text-green-400"/>
                        <span className="text-sm text-green-300">RR ≥ 1.5 (clinically meaningful)</span>
                    </div>
                    <div className="flex items-center gap-2 p-2 bg-green-500/10 rounded">
                        <CheckCircle className="w-4 h-4 text-green-400"/>
                        <span className="text-sm text-green-300">Actionable (treatment modification)</span>
                    </div>
                </div>
            </div>
        </motion.div>
    </div>
);

//================================================================================
// SLIDE 8: CLINICAL ACTIONS
//================================================================================

const ClinicalActionsSlide = () => (
    <div className="h-full flex flex-col justify-center px-8">
        <motion.div 
            className="text-center mb-8"
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
        >
            <h2 className="text-4xl font-black text-white mb-2">
                Clinical Action Plan
            </h2>
            <p className="text-slate-400">From risk prediction to actionable recommendations</p>
        </motion.div>
        
        {/* Two Scenarios */}
        <motion.div 
            className="grid md:grid-cols-2 gap-8 max-w-6xl mx-auto"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
        >
            {/* HIGH RISK */}
            <div className="p-6 bg-red-500/5 border border-red-500/30 rounded-2xl">
                <div className="flex items-center gap-3 mb-6">
                    <div className="p-3 bg-red-500/20 rounded-xl">
                        <AlertTriangle className="w-8 h-8 text-red-400"/>
                    </div>
                    <div>
                        <p className="text-red-400 font-bold text-xl">HIGH RISK</p>
                        <p className="text-xs text-slate-400">MAPK/NF1 mutation detected</p>
                    </div>
                </div>
                
                <div className="space-y-3">
                    {[
                        { icon: Clock, action: "Earlier PARP switch", detail: "Before standard progression" },
                        { icon: Activity, action: "ctDNA every 6 weeks", detail: "Not standard 12 weeks" },
                        { icon: Microscope, action: "Imaging every 8 weeks", detail: "Tighter monitoring" },
                        { icon: FlaskConical, action: "Pre-identify ATR/CHK1 trials", detail: "Backup plan ready" },
                        { icon: Users, action: "Patient counseling", detail: "Discuss resistance risk" }
                    ].map((item, i) => (
                        <motion.div 
                            key={i}
                            className="flex items-center gap-3 p-3 bg-slate-900/50 rounded-lg"
                            initial={{ opacity: 0, x: -20 }}
                            animate={{ opacity: 1, x: 0 }}
                            transition={{ delay: 0.4 + i * 0.1 }}
                        >
                            <item.icon className="w-5 h-5 text-red-400"/>
                            <div>
                                <p className="text-white font-medium text-sm">{item.action}</p>
                                <p className="text-xs text-slate-400">{item.detail}</p>
                            </div>
                        </motion.div>
                    ))}
                </div>
            </div>
            
            {/* BASELINE RISK */}
            <div className="p-6 bg-green-500/5 border border-green-500/30 rounded-2xl">
                <div className="flex items-center gap-3 mb-6">
                    <div className="p-3 bg-green-500/20 rounded-xl">
                        <CheckCircle className="w-8 h-8 text-green-400"/>
                    </div>
                    <div>
                        <p className="text-green-400 font-bold text-xl">BASELINE RISK</p>
                        <p className="text-xs text-slate-400">No MAPK/NF1 mutation</p>
                    </div>
                </div>
                
                <div className="space-y-3">
                    {[
                        { icon: Pill, action: "Standard platinum regimen", detail: "Expected normal response" },
                        { icon: Activity, action: "Standard ctDNA schedule", detail: "Every 12 weeks" },
                        { icon: Clock, action: "Standard monitoring", detail: "Per guidelines" },
                        { icon: Target, action: "PARP if HRD+", detail: "Based on HRD status" },
                        { icon: Database, action: "Focus on HRD status", detail: "Primary eligibility driver" }
                    ].map((item, i) => (
                        <motion.div 
                            key={i}
                            className="flex items-center gap-3 p-3 bg-slate-900/50 rounded-lg"
                            initial={{ opacity: 0, x: 20 }}
                            animate={{ opacity: 1, x: 0 }}
                            transition={{ delay: 0.4 + i * 0.1 }}
                        >
                            <item.icon className="w-5 h-5 text-green-400"/>
                            <div>
                                <p className="text-white font-medium text-sm">{item.action}</p>
                                <p className="text-xs text-slate-400">{item.detail}</p>
                            </div>
                        </motion.div>
                    ))}
                </div>
            </div>
        </motion.div>
    </div>
);

//================================================================================
// SLIDE 9: SUMMARY
//================================================================================

const SummarySlide = () => (
    <div className="h-full flex flex-col justify-center px-8">
        <motion.div 
            className="text-center mb-8"
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
        >
            <h2 className="text-5xl font-black text-white mb-4">
                The Bottom Line
            </h2>
            <p className="text-xl text-slate-400">
                Resistance prediction that actually works
            </p>
        </motion.div>
        
        {/* Key Metrics */}
        <motion.div 
            className="grid grid-cols-4 gap-6 max-w-4xl mx-auto mb-8"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
        >
            {[
                { value: "469", label: "Patients", icon: Users },
                { value: "1.97×", label: "Relative Risk", icon: TrendingUp },
                { value: "7D", label: "Mechanism Vector", icon: Layers },
                { value: "32K", label: "SAE Features", icon: Brain }
            ].map((item, i) => (
                <motion.div 
                    key={i}
                    className="p-6 bg-slate-800/50 border border-slate-700 rounded-2xl text-center"
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ delay: 0.4 + i * 0.1 }}
                >
                    <item.icon className="w-8 h-8 text-purple-400 mx-auto mb-3"/>
                    <p className="text-3xl font-black text-white">{item.value}</p>
                    <p className="text-sm text-slate-400">{item.label}</p>
                </motion.div>
            ))}
        </motion.div>
        
        {/* Before/After */}
        <motion.div 
            className="max-w-4xl mx-auto mb-8"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.7 }}
        >
            <div className="grid md:grid-cols-2 gap-6">
                <div className="p-6 bg-red-500/5 border border-red-500/20 rounded-xl">
                    <p className="text-red-300 font-semibold mb-2">Before:</p>
                    <p className="text-xl text-slate-300 italic">"We'll monitor and see if you become resistant."</p>
                </div>
                <div className="p-6 bg-purple-500/5 border border-purple-500/20 rounded-xl">
                    <p className="text-purple-300 font-semibold mb-2">After:</p>
                    <p className="text-xl text-white">"Your MAPK mutation predicts 2× resistance risk. Here's your personalized action plan."</p>
                </div>
            </div>
        </motion.div>
        
        {/* Final CTA */}
        <motion.div 
            className="text-center"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.9 }}
        >
            <p className="text-2xl text-white max-w-3xl mx-auto">
                That's not guessing. That's <span className="text-purple-400 font-bold">precision oncology.</span>
            </p>
        </motion.div>
    </div>
);

//================================================================================
// MAIN APP WITH SLIDE CONTROL
//================================================================================

export default function App() {
    const [currentSlide, setCurrentSlide] = useState(0);
    
    const slides = [
        { id: 'hero', component: HeroSlide },
        { id: 'problem', component: ResistanceProblemSlide },
        { id: 'architecture', component: TechnicalArchitectureSlide },
        { id: 'mechanism', component: MechanismVectorSlide },
        { id: 'sae', component: SAESlide },
        { id: 'prophet', component: ResistanceProphetSlide },
        { id: 'validation', component: ValidationSlide },
        { id: 'actions', component: ClinicalActionsSlide },
        { id: 'summary', component: SummarySlide }
    ];
    
    const nextSlide = () => setCurrentSlide(prev => Math.min(prev + 1, slides.length - 1));
    const prevSlide = () => setCurrentSlide(prev => Math.max(prev - 1, 0));
    
    // Keyboard navigation
    React.useEffect(() => {
        const handleKeyDown = (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
    }, []);
    
    const CurrentSlideComponent = slides[currentSlide].component;
    
    return (
        <main className="relative w-full h-screen bg-slate-900 font-sans overflow-hidden">
            {/* Background */}
            <div className="absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-black/40 z-0"/>
            
            {/* Slide Content */}
            <div className="relative z-10 h-full">
                <AnimatePresence mode="wait">
                    <motion.div
                        key={currentSlide}
                        initial={{ opacity: 0, x: 50 }}
                        animate={{ opacity: 1, x: 0 }}
                        exit={{ opacity: 0, x: -50 }}
                        transition={{ duration: 0.3 }}
                        className="h-full"
                    >
                        <CurrentSlideComponent />
                    </motion.div>
                </AnimatePresence>
            </div>
            
            {/* Navigation */}
            <SlideNav 
                current={currentSlide} 
                total={slides.length}
                onPrev={prevSlide}
                onNext={nextSlide}
            />
        </main>
    );
}
