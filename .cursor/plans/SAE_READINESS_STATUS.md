# SAE Readiness Status - MBD4+TP53 Target

**Date**: January 28, 2025 (Updated)  
**Status**: ‚úÖ **TRUE SAE DEPLOYED + REAL Tier-3 predictive baseline (AUROC 0.783 ¬± 0.100) + DDR_bin diamonds (RUO)** | ‚ö†Ô∏è **PROXY SAE REMAINS PRODUCTION WORKHORSE**

---

## üö® CRITICAL CLARIFICATION: What Is Real vs Synthetic

### ‚úÖ VALIDATED ON REAL DATA (Safe to Claim)

| Validation | Data Source | Outcome | Method | Result |
|------------|-------------|---------|--------|--------|
| **MAPK/NF1 Resistance** | TCGA-OV (469 patients) | Real platinum response | Gene-level (Proxy) | RR=1.97 ‚úÖ |
| **DIS3 Resistance** | MMRF CoMMpass (219 patients) | Real mortality | Gene-level | RR=2.08, p=0.0145 ‚úÖ |
| **TP53 Resistance** | MMRF CoMMpass (219 patients) | Real mortality | Gene-level | RR=1.90 ‚úÖ |
| **TMB Calculation** | TCGA Pan-Immune (1,895 patients) | External ground truth | Correlation | r=0.933 ‚úÖ |

**These resistance predictions are VALID** - they use:
- Real patient mutations from cBioPortal/GDC
- Real clinical outcomes (platinum response, mortality)
- Gene-level analysis (mutation present ‚Üí outcome correlation)
- **NOT dependent on TRUE SAE features**

### ‚ö†Ô∏è SYNTHETIC DATA (Do NOT Use for Claims)

| Dataset | Location | Size | What's Synthetic |
|---------|----------|------|------------------|
| **MOCK SAE Cohort (Synthetic; pipeline test only)** | Generated by `scripts/sae/generate_mock_sae_cohort.py` (output file may exist locally as `sae_features_tcga_ov_platinum_MOCK.json`) | ~GBs | Injected signals (e.g. features 100‚Äì102 / 200‚Äì202 / 300‚Äì302) engineered to correlate with outcome |
| **MOCK Biomarker Analysis (Synthetic)** | Derived from MOCK cohort (often named `sae_tcga_ov_platinum_biomarkers_MOCK.json`) | ~KB | ‚Äú352 significant features‚Äù is expected because signals were engineered ‚Äî **do not use for biology/clinical claims** |

### ‚ö†Ô∏è INCOMPLETE DATA (Real but Insufficient)

| Dataset | Location | Size | Issue |
|---------|----------|------|-------|
| **Tier-1 Real SAE Cohort (small)** | `data/validation/sae_cohort/sae_features_tcga_ov_platinum.json` | 2.5MB | 10 patients (9 sensitive, 1 resistant) ‚Äî too small to claim outcome prediction |
| **Tier-1 Real Biomarker Output (small)** | `data/validation/sae_cohort/sae_tcga_ov_platinum_biomarkers.json` | 797B | Real but underpowered; not informative |
| **Tier-3 Real SAE Cohort (checkpoint)** | `oncology-coPilot/oncology-backend-minimal/data/validation/sae_cohort/checkpoints/Tier3_validation_cohort.json` | (checkpoint) | 149 patients: 125 sensitive, 7 resistant, 17 refractory (positive=24). Patient map is under top-level `data` |
| **Tier-3 Real Biomarker Scan (checkpoint)** | `oncology-coPilot/oncology-backend-minimal/data/validation/sae_cohort/checkpoints/sae_validation_results.json` | (checkpoint) | 0 significant after FDR; 11 large-effect features; 136 medium-effect features |

### How the 5.3GB MOCK File Was Created

The MOCK file was generated by `scripts/sae/generate_mock_sae_cohort.py`:
```python
# From lines 17-21 of the script:
# "Real biological signals:
# - Features 100-102: Synthetic "DDR-like" features (higher in sensitive)
# - Features 200-202: Synthetic "MAPK-like" features (higher in resistant)
# - Features 300-302: Synthetic "IO-like" features (correlated with outcome)
# All other features: Random noise"
```

**The "352 significant features" finding was on MOCK data** - specifically, features 100-102, 200-202, 300-302 were ENGINEERED to correlate with outcomes. This is test data for pipeline verification, NOT real biological discovery.

---

## üî¨ TRUE SAE VALIDATION (January 28, 2025) - COMPLETED

### Full Extraction Results

| Tier | Patients | Status |
|------|----------|--------|
| Tier 1 (Proof of Concept) | 10 | ‚úÖ Complete |
| Tier 2 (Statistical Minimum) | 49 | ‚úÖ Complete |
| Tier 3 (Validation Cohort) | 149 | ‚úÖ Complete |

### Feature Analysis Results

| Metric | Result |
|--------|--------|
| **Patients extracted** | 149 |
| **Sensitive** | 125 (84%) |
| **Resistant/Refractory** | 24 (16%) |
| **Features analyzed** | 1,571 |
| **Significant (FDR < 0.05)** | **0** ‚ùå |
| **Significant (FDR < 0.10)** | **0** ‚ùå |
| **Large effect (|d| ‚â• 0.5)** | 11 ‚ö†Ô∏è |
| **Medium effect (|d| ‚â• 0.3)** | 136 |

### Tier-3 Predictive Baseline (AUROC 0.783) ‚Äî What It Is vs What It Is Not

**What it is (REAL):** a reproducible, cross-validated **predictive baseline** on the **real Tier-3 cohort** (149 TCGA-OV patients; positive = resistant + refractory = 24).

- **Artifact**: `oncology-coPilot/oncology-backend-minimal/data/validation/sae_cohort/checkpoints/true_sae_diamonds_baseline.v1.json`
- **Result**: mean AUROC = **0.783 ¬± 0.100**
- **Labels**: resistant + refractory vs sensitive
- **Features**: 29 total (9 ‚Äúdiamond‚Äù features + 20 additional features)

**What it is NOT (not safe to claim):**
- Not an FDA-grade / clinically validated outcome predictor
- Not externally validated on an independent cohort
- Not proof that any *single* SAE feature is a statistically significant biomarker after multiple-hypothesis correction

**How AUROC 0.783 can coexist with ‚Äú0 FDR-significant features‚Äù:**
- The FDR scan asks: ‚Äúwhich individual features survive multiple testing?‚Äù ‚Üí none
- The AUROC baseline asks: ‚Äúcan a multivariate feature set separate labels under CV?‚Äù ‚Üí yes (promising RUO baseline)

### Top Features (Not Significant After FDR Correction)

| Rank | Feature | P-value | Cohen's d | Direction |
|------|---------|---------|-----------|-----------|
| 1 | 5290 | 0.0008 | -0.50 | Higher in sensitive |
| 2 | 14432 | 0.0011 | -0.42 | Higher in sensitive |
| 3 | 11032 | 0.0014 | -0.42 | Higher in sensitive |
| 12 | 23140 | 0.0030 | -0.56 | Higher in sensitive |

### Conclusion: **SAE_SHOWS_PROMISE**

```
Tier-3 results support two simultaneous truths:

1) Biomarker discovery is not yet clean: 0 features survive FDR correction on Tier-3
   ‚Üí we cannot claim specific SAE feature biomarkers.

2) Predictive signal exists: a locked, reproducible baseline on Tier-3 achieves
   AUROC 0.783 ¬± 0.100 using a selected 29-feature set.

DECISION:
- Keep PROXY SAE as the production workhorse (validated gene-level markers; simplest and safest).
- Treat TRUE SAE as RUO: use the Tier-3 baseline + DDR_bin diamonds for interpretation/counterfactuals,
  but do not market as clinical outcome prediction until external validation + locked protocol are complete.
```

### Pre-Validation Tests

| Test | Result | Evidence |
|------|--------|----------|
| **Service Deployed** | ‚úÖ | Modal endpoint operational |
| **Trained Weights** | ‚úÖ | `Goodfire/Evo-2-Layer-26-Mixed (trained weights)` |
| **Deterministic** | ‚úÖ | 100% top feature overlap across 3 runs |
| **Differentiates Contexts** | ‚úÖ | KRAS vs EGFR: 40.6% overlap (different features activated) |

### TRUE SAE Capabilities Confirmed

```
Response Structure:
‚îú‚îÄ‚îÄ top_features: 64 features (TopK=64, by design)
‚îú‚îÄ‚îÄ layer: blocks.26
‚îú‚îÄ‚îÄ stats: 
‚îÇ   ‚îú‚îÄ‚îÄ sparsity: 0.00195 (99.8% zeros)
‚îÇ   ‚îú‚îÄ‚îÄ mean_activation: 2.47
‚îÇ   ‚îî‚îÄ‚îÄ shape: [1, 8193, 32768]
‚îî‚îÄ‚îÄ provenance:
    ‚îú‚îÄ‚îÄ method: batch_topk_tied_sae
    ‚îú‚îÄ‚îÄ d_in: 4096
    ‚îú‚îÄ‚îÄ d_hidden: 32768
    ‚îî‚îÄ‚îÄ model: "trained weights" ‚úÖ
```

### What TRUE SAE Does

- **Genomic Context Differentiation**: Different genes ‚Üí different features activated
- **Interpretability**: 64 active features per variant explain what Evo2 "sees"
- **Consistency**: Same variant ‚Üí same features (deterministic)

### What TRUE SAE Does NOT Do (Yet)

- ‚ö†Ô∏è **Clinical-grade outcome prediction**: We have a real Tier-3 AUROC baseline (0.783), but it is **RUO** (needs external validation + locked protocol).
- ‚ö†Ô∏è **Global Feature‚ÜíBiology Mapping**: We mapped the 9 diamond features to **DDR_bin**, but the full 32K mapping is incomplete.
- ‚úÖ/**‚ö†Ô∏è Production**: PROXY remains production workhorse; TRUE SAE is an overlay until validated across cohorts and locked.

---

## üéØ Mission Context

**Primary Target**: MBD4 Germline + TP53 Somatic HGSOC Analysis
- Requires accurate pathway burden (BER + HRD deficiency)
- Needs mechanism fit ranking for PARP inhibitor trials
- Requires early resistance detection (DNA repair capacity)
- **Proxy SAE (gene-level) is SUFFICIENT for current needs**

**Current Reality**:
- ‚úÖ TRUE SAE service deployed (trained weights, deterministic)
- ‚úÖ Proxy SAE validated for resistance prediction (MAPK RR=1.97, DIS3 RR=2.08)
- ‚ö†Ô∏è TRUE SAE‚Üíoutcome correlation NOT validated
- **Impact**: MBD4+TP53 can proceed with Proxy SAE (validated) while TRUE SAE is optional enhancement

---

## ‚úÖ What We've Accomplished

### January 28, 2025 - TRUE SAE Validation

| Test | Status | Finding |
|------|--------|---------|
| Deploy SAE to Modal | ‚úÖ | `https://crispro--sae-service-saeservice-api.modal.run` |
| Trained Weights | ‚úÖ | `Goodfire/Evo-2-Layer-26-Mixed` loaded correctly |
| Stability Test | ‚úÖ | 100% deterministic (3 runs, same output) |
| Differentiation Test | ‚úÖ | KRAS vs EGFR: 40.6% feature overlap (different contexts ‚Üí different features) |
| MOCK Data Discovery | ‚ö†Ô∏è | Identified that `sae_features_tcga_ov_platinum_MOCK.json` has synthetic signals |

### January 14-20, 2025 - Infrastructure

1. **Evo2 7B Migration** ‚úÖ - Migrated from evo2_1b to evo2_7b, trained weights loaded
2. **Full Cohort Extraction** ‚úÖ - 66 patients, 2,897 variants (but using random init at the time)
3. **Health Check Suite Created** ‚úÖ - Data quality, feature distribution, pipeline integration scripts
4. **Clinical Trials Integration** ‚úÖ - Mechanism fit ranking documented

### üõ°Ô∏è Resistance Prediction Validation (CONFIRMED REAL DATA - SAFE TO CLAIM)

| Validation | Data Source | N | Ground Truth | Method | Result | Status |
|------------|-------------|---|--------------|--------|--------|--------|
| **MAPK/NF1** | cBioPortal TCGA-OV | 469 | Platinum response | Gene mutation ‚Üí Chi-square | RR=1.97 | ‚úÖ REAL |
| **DIS3** | GDC MMRF CoMMpass | 219 | Vital status (mortality) | Gene mutation ‚Üí Chi-square | RR=2.08, p=0.0145 | ‚úÖ REAL |
| **TP53** | GDC MMRF CoMMpass | 219 | Vital status (mortality) | Gene mutation ‚Üí Chi-square | RR=1.90 | ‚úÖ REAL |
| **TMB** | TCGA Pan-Immune | 1,895 | Published TMB (mutation-load_updated.txt) | Pearson correlation | r=0.933 | ‚úÖ REAL |

### Why These Are Valid

1. **Data Sources**: Real patient data from cBioPortal (TCGA) and GDC (MMRF CoMMpass)
2. **Outcomes**: Real clinical outcomes - platinum response (TCGA-OV) and mortality (MMRF)
3. **Method**: Gene-level mutation presence ‚Üí outcome correlation (simple, interpretable)
4. **Independence**: These validations **do NOT use SAE features at all**
5. **Statistical Significance**: DIS3 p=0.0145, MAPK RR=1.97 (2x risk)

### What Was Validated vs Not Validated (Important)

| Item | Status | Evidence / Artifact |
|------|--------|--------------------|
| **PROXY resistance markers (MAPK/NF1, DIS3, TP53, TMB)** | ‚úÖ Validated (real outcomes) | Gene-level analyses on TCGA-OV / MMRF CoMMpass / TCGA Pan-Immune |
| **TRUE SAE predictive baseline (OV platinum)** | ‚úÖ Validated as RUO baseline | `oncology-coPilot/oncology-backend-minimal/data/validation/sae_cohort/checkpoints/true_sae_diamonds_baseline.v1.json` (AUROC 0.783 ¬± 0.100 on Tier-3 real) |
| **TRUE SAE biomarker list after FDR correction** | ‚ùå Not validated | `oncology-coPilot/oncology-backend-minimal/data/validation/sae_cohort/checkpoints/sae_validation_results.json` ‚Üí 0 FDR-significant |
| **Feature‚ÜíBiology mapping (global 32K)** | ‚ö†Ô∏è Partial | DDR_bin mapping exists for 9 diamond features; global mapping is incomplete |
| **External / prospective validation** | ‚ùå Not done | Needs independent cohort + locked protocol |

**Bottom line:** PROXY SAE = production workhorse. TRUE SAE = real signal + RUO baseline + partial mapping (DDR_bin diamonds), but **not** something we market as clinical outcome prediction yet.

---

## ‚è∏Ô∏è What's Ready to Execute

### 1. Health Checks ‚è∏Ô∏è **READY**
- All health check scripts created and executable
- Pre-flight checklist defined
- Execution order documented

**Next Step**: Run health checks to verify system operational

### 2. Biomarker Analysis Re-Run ‚è∏Ô∏è **READY** (Blocked by health checks)
- Service ready, bug fixed
- Data quality verified
- Command ready: `python3 scripts/sae/analyze_biomarkers.py --input data/validation/sae_cohort/sae_features_tcga_ov_platinum.json`

**Next Step**: After health checks pass, run biomarker analysis

### 3. Feature‚ÜíPathway Mapping Strategy ‚è∏Ô∏è **DEFINED** (Pending biomarker results)
- Strategy: Biomarker-driven mapping (gene‚Üípathway inference)
- Validation plan: Test on known cases (BRCA1 ‚Üí DDR, KRAS ‚Üí MAPK, MBD4+TP53 ‚Üí DDR)
- Implementation approach documented

**Next Step**: After biomarker analysis, create mapping

### 4. MBD4+TP53 End-to-End Test ‚è∏Ô∏è **READY** (Blocked by health checks)
- Plan exists: `.cursor/plans/MBD4.mdc`
- Test cases defined
- Expected results documented

**Next Step**: After health checks pass, run end-to-end test

---

## üö® Fail Now vs Later Assessment (MBD4+TP53 Critical Path)

### ‚ö†Ô∏è FAIL NOW - Must Fix Before MBD4+TP53 Analysis (P0 - 5.5-7.5 hours)

**Gap 0: Mechanism Vector Conversion Function** ‚ö†Ô∏è **BLOCKING MBD4+TP53 Phase 4**

- **Issue**: MBD4+TP53 analysis Phase 4 (Clinical Trial Matching) requires mechanism vector conversion, but `convert_pathway_scores_to_mechanism_vector()` function does NOT exist
- **Impact**: **BLOCKS MBD4+TP53 Phase 4** - Cannot rank trials by mechanism fit without 7D mechanism vector
- **MBD4+TP53 Requirements**:
  - Extract pathway scores from `/api/efficacy/predict` response: `provenance["confidence_breakdown"]["pathway_disruption"]`
  - Convert to 7D vector: [DDR, MAPK, PI3K, VEGF, HER2, IO, Efflux]
  - DDR index must include: `ddr + 0.5 * tp53` (TP53 contributes 50% to DDR)
  - IO index: `1.0 if (tmb >= 20 or msi_high) else 0.0`
- **Resolution**: Create `api/services/pathway_to_mechanism_vector.py` (1.5-2.5 hours)
- **Reference**: `.cursor/plans/clinical-trials.mdc` (lines 712-757) for design

**Gap 3.5: MBD4+TP53 Validation Test Suite Missing** ‚ö†Ô∏è **BLOCKING MBD4+TP53 Analysis**

- **Issue**: MBD4+TP53 analysis requires validation that system works correctly, but no test suite exists
- **Impact**: **BLOCKS MBD4+TP53 Analysis Execution** - Cannot verify system produces accurate predictions
- **MBD4+TP53 Requirements**:
  1. Frameshift Detection: MBD4 c.1239delA ‚Üí sequence_disruption ‚â•0.8
  2. Hotspot Detection: TP53 R175H ‚Üí sequence_disruption ‚â•0.7
  3. Pathway Aggregation: MBD4+TP53 ‚Üí DDR pathway score ‚â•0.70
  4. PARP Ranking: MBD4+TP53 ‚Üí PARP inhibitors rank #1-2, efficacy_score >0.80
  5. Germline Status: MBD4 germline-positive ‚Üí no PARP penalty
  6. Mechanism Vector: MBD4+TP53 pathway scores ‚Üí 7D mechanism vector correct
  7. Trial Matching: MBD4+TP53 ‚Üí mechanism fit ranking works
- **Resolution**: Create validation test scripts (2.5-3.5 hours)
- **Files**: `scripts/test_mbd4_tp53_*.py`, `tests/test_mbd4_tp53_analysis.py`

**Gap 3.6: Frameshift/Truncation Detection Validation** ‚ö†Ô∏è **CRITICAL FOR MBD4**

- **Issue**: MBD4 c.1239delA is frameshift - need to verify truncation lift works correctly
- **Current Implementation**: `evo2_scorer.py:151-157` applies 1.0 lift for truncation/frameshift variants
- **MBD4+TP53 Requirements**:
  - MBD4 frameshift (c.1239delA, p.Ile413Serfs*2) ‚Üí sequence_disruption ‚â•0.8
  - Verify truncation lift applied (1.0 multiplier)
  - Verify contributes to DDR pathway correctly
- **Resolution**: Test MBD4 frameshift and TP53 hotspot (45 minutes)

**Gap 3.7: DDR Pathway Score Validation** ‚ö†Ô∏è **CRITICAL FOR MBD4+TP53**

- **Issue**: MBD4+TP53 combination must produce high DDR pathway scores for accurate PARP predictions
- **MBD4+TP53 Requirements**:
  - MBD4+TP53 combination ‚Üí DDR pathway score ‚â•0.70
  - Both variants contribute to pathway aggregation
  - PARP inhibitors get high efficacy_score (>0.80) for MBD4+TP53
- **Resolution**: Test pathway aggregation and PARP predictions (1 hour)

**Total P0 Time (MBD4+TP53 Critical Path)**: 5.5-7.5 hours

### ‚è∏Ô∏è FAIL LATER - Can Address During Development (P1-P2)

**Gap 1: ClinVar BRCA1/BRCA2 Training Data** ‚úÖ **RESOLVED** (Found existing pipeline)
- Existing script: `src/tools/adjudicator_trainer/01_parse_variant_summary.py`
- BRCA1/BRCA2 included in TARGET_GENES
- **Action**: Verify data exists or re-run extraction (15-45 minutes)

**Gap 2: Evo2 Embeddings Extraction** ‚úÖ **PARTIALLY RESOLVED** (Pattern exists)
- Pattern exists: `src/tools/adjudicator_trainer/02_generate_embeddings.py`
- Need to adapt for Evo2 (not Zeta Oracle)
- **Action**: Verify endpoint and adapt script (1.75-2.75 hours)

**Gap 3: Base Scorer Interface** ‚ö†Ô∏è **IMPORTANT** (Can work around)
- **Impact**: Blocks clean integration of new scorers
- **Resolution**: Create `api/services/sequence_scorers/base_scorer.py` (1-2 hours)
- **Note**: Less critical than MBD4+TP53 gaps (can work around it)

**Gap 4-7: Training Infrastructure, Model Storage, Splice Detection, Noncoding** ‚ö†Ô∏è **P1-P2**
- Can be addressed during development
- Not blocking MBD4+TP53 analysis

---

## üìä Proxy SAE vs TRUE SAE - Decision Matrix

### What We Have

| Capability | PROXY SAE | TRUE SAE |
|------------|----------|----------|
| **Implementation** | Gene ‚Üí pathway lookup | Evo2 layer-26 ‚Üí 32K sparse features ‚Üí derived bins (e.g., DDR_bin) |
| **Outcome evidence** | ‚úÖ Real-outcome validated (RR on real cohorts) | ‚úÖ Real Tier-3 **RUO** baseline (AUROC 0.783 ¬± 0.100 on OV platinum) |
| **Biomarker evidence (FDR-corrected)** | ‚úÖ (gene-level) | ‚ùå 0 features survive FDR on Tier-3 |
| **Interpretability** | High (genes/pathways) | High for DDR_bin diamonds; medium overall (mapping incomplete) |
| **Production stance** | ‚úÖ Workhorse | ‚ö†Ô∏è RUO overlay until external validation + locked protocol |

### Recommendation

**Use Proxy SAE for Production** - It's validated and works:
- MAPK mutations ‚Üí 2x resistance risk (validated)
- DIS3 mutations ‚Üí 2x mortality risk (validated)
- TP53 mutations ‚Üí 1.9x mortality risk (validated)

**Use TRUE SAE as RUO overlay** (research + interpretation + counterfactuals):
- Deterministic/stable extraction is confirmed
- Tier-3 predictive baseline exists (AUROC 0.783)
- DDR_bin diamond mapping exists (9/9 features)
- Still needs external validation + locked feature-selection protocol before any clinical outcome claims

### TRUE SAE Blocker: Feature‚ÜíOutcome Correlation

**Status**: ‚ö†Ô∏è **OPTIONAL ENHANCEMENT, NOT BLOCKER**

**To Validate TRUE SAE Adds Value**:
1. Run **head-to-head** on the same cohort: PROXY-only vs TRUE-only vs PROXY+DDR_bin
2. Lock feature-selection and CV protocol to eliminate leakage
3. Validate on an **independent cohort** (or a held-out site split)
4. Only then upgrade TRUE SAE from RUO ‚Üí production

**Current Recommendation**: Proceed with Proxy SAE (validated). TRUE SAE is a nice-to-have enhancement, not a requirement.

---

## üìã Immediate Next Steps (Prioritized by Fail Now vs Later)

### ‚ö†Ô∏è FAIL NOW - Before MBD4+TP53 Analysis (P0 - 5.5-7.5 hours)

**Step 0: Fix Critical Gaps** (5.5-7.5 hours - MBD4+TP53 Critical Path)

1. **Create Mechanism Vector Conversion** (1.5-2.5 hours)
   - File: `api/services/pathway_to_mechanism_vector.py`
   - Function: `convert_pathway_scores_to_mechanism_vector(pathway_scores, tmb, msi_status)`
   - Test with MBD4+TP53 pathway scores
   - **BLOCKS**: Phase 4 trial matching

2. **Create MBD4+TP53 Validation Test Suite** (2.5-3.5 hours)
   - `scripts/test_mbd4_tp53_sequence_scoring.py` - Frameshift/hotspot validation
   - `scripts/test_mbd4_tp53_pathway_aggregation.py` - DDR pathway validation
   - `scripts/test_mbd4_tp53_parp_predictions.py` - PARP ranking validation
   - `tests/test_mbd4_tp53_analysis.py` - Comprehensive test suite
   - **BLOCKS**: Analysis execution

3. **Validate Frameshift/Truncation Detection** (45 minutes)
   - Test MBD4 c.1239delA ‚Üí sequence_disruption ‚â•0.8
   - Test TP53 R175H ‚Üí sequence_disruption ‚â•0.7
   - Verify truncation lift applied
   - **CRITICAL**: For MBD4 frameshift detection

4. **Validate DDR Pathway Scores** (1 hour)
   - Test MBD4+TP53 ‚Üí DDR pathway score ‚â•0.70
   - Test PARP inhibitors rank #1-2, efficacy_score >0.80
   - Verify both variants contribute
   - **CRITICAL**: For accurate PARP predictions

**Success Criteria**: All 7 MBD4+TP53 test cases pass before analysis execution

### ‚úÖ Standard Next Steps (After P0 Gaps Fixed)

**Step 1: Run Health Checks** (30 min)
```bash
# 1. Data quality
python3 scripts/sae/health_check_data.py

# 2. Feature distributions
python3 scripts/sae/health_check_feature_distributions.py

# 3. Pipeline integration
python3 scripts/sae/health_check_pipeline.py

# 4. Modal service health
curl https://crispro--sae-service-saeservice-api.modal.run/health
curl https://crispro--evo-service-evoservice7b-api-7b.modal.run/health
curl http://localhost:8000/api/sae/health
```

**Step 2: Re-Run Biomarker Analysis** (30 min)
```bash
python3 scripts/sae/analyze_biomarkers.py \
  --input data/validation/sae_cohort/sae_features_tcga_ov_platinum.json \
  --output data/validation/sae_cohort/sae_tcga_ov_platinum_biomarkers.json \
  --plots-dir data/validation/sae_cohort/plots
```

**Step 3: Create Feature‚ÜíPathway Mapping** (2-4 hours)
- Use top significant features from biomarker analysis
- Map features to pathways via gene associations
- Validate on known cases
- Integrate into SAE Feature Service

**Step 4: MBD4+TP53 End-to-End Test** (1 hour)
- Run complete analysis pipeline
- Verify pathway scores, drug predictions, trial matching
- Compare proxy vs TRUE SAE results (when mapping ready)

### ‚è∏Ô∏è FAIL LATER - During Development (P1-P2)

**Gap 1: ClinVar Data Verification** (15-45 minutes)
- Check if `data/adjudicator_training/clinvar_missense_labels.csv` exists
- Filter for BRCA1/BRCA2 variants
- Re-run extraction if needed

**Gap 2: Evo2 Embeddings Extraction** (1.75-2.75 hours)
- Verify `/api/evo/score_variant_with_activations` works for 1B/7B
- Adapt extraction script from existing pattern
- Test with sample variants

**Gap 3: Base Scorer Interface** (1-2 hours)
- Create `api/services/sequence_scorers/base_scorer.py`
- Update existing scorers to implement interface
- **Note**: Can work around this, less critical than MBD4+TP53 gaps

---

## üîó Key Documents

- **Readiness Plan**: `.cursor/plans/SAE_READINESS_AND_BLOCKER_REMOVAL_PLAN.md`
- **Master Plan**: `.cursor/plans/final-comprehensive-document-review-bad14970.plan.md`
- **MBD4 Plan**: `.cursor/plans/MBD4.mdc`
- **Uncertainties**: `.cursor/ayesha/PLAN_UNCERTAINTIES_AND_RISKS.md`
- **Pipeline Roadmap**: `.cursor/rules/SAE_TO_RESISTANCE_PROPHET_PIPELINE.mdc`
- **Fail Now vs Later**: `.cursor/plans/FAIL_NOW_VS_LATER_ASSESSMENT.md` - Critical gaps assessment
- **Pre-Development Readiness**: `.cursor/plans/PRE_DEVELOPMENT_READINESS_ASSESSMENT.md` - Infrastructure readiness

---

## ‚ö†Ô∏è Critical Questions Requiring Answers

### Q1: Mechanism Vector Conversion Function
- **Question**: Does `convert_pathway_scores_to_mechanism_vector()` exist?
- **Answer**: ‚ùå **NO** - Must be created (1.5-2.5 hours)
- **Impact**: BLOCKS MBD4+TP53 Phase 4 (trial matching)
- **Action**: Create function before running MBD4+TP53 analysis

### Q2: MBD4+TP53 Validation Test Suite
- **Question**: Do validation tests exist for MBD4+TP53 analysis?
- **Answer**: ‚ùå **NO** - Must be created (2.5-3.5 hours)
- **Impact**: BLOCKS MBD4+TP53 analysis execution
- **Action**: Create test suite before running analysis

### Q3: Frameshift Detection Validation
- **Question**: Does MBD4 c.1239delA frameshift get correct sequence_disruption?
- **Answer**: ‚ö†Ô∏è **UNKNOWN** - Must be validated (45 minutes)
- **Impact**: CRITICAL for MBD4 analysis accuracy
- **Action**: Test frameshift detection before analysis

### Q4: DDR Pathway Score Validation
- **Question**: Does MBD4+TP53 combination produce DDR ‚â•0.70?
- **Answer**: ‚ö†Ô∏è **UNKNOWN** - Must be validated (1 hour)
- **Impact**: CRITICAL for PARP inhibitor predictions
- **Action**: Test pathway aggregation before analysis

### Q5: S/P/E Integration Status
- **Question**: How does SAE integrate with S/P/E framework?
- **Answer**: ‚úÖ **CLARIFIED** - SAE uses S/P/E outputs but doesn't modulate S/P/E confidence yet
- **Impact**: Understanding current capabilities vs. manager's vision
- **Action**: Documented in Phase 13 of master plan

---

## üìä Readiness Checklist

### Before MBD4+TP53 Analysis (P0 - Must Complete)

- [ ] **Gap 0**: Mechanism vector conversion function created and tested
- [ ] **Gap 3.5**: MBD4+TP53 validation test suite created (all 7 test cases)
- [ ] **Gap 3.6**: Frameshift/truncation detection validated (MBD4 ‚â•0.8, TP53 ‚â•0.7)
- [ ] **Gap 3.7**: DDR pathway validation passed (MBD4+TP53 ‚Üí DDR ‚â•0.70)
- [ ] **Health Checks**: All health check scripts pass
- [ ] **MBD4+TP53 Tests**: All 7 validation test cases pass

### Before Development (P1 - Should Complete)

- [ ] **Gap 1**: ClinVar BRCA1/BRCA2 extraction verified (15-45 minutes)
- [ ] **Gap 2**: Evo2 embeddings extraction verified (1.75-2.75 hours)
- [ ] **Gap 3**: Base scorer interface created (1-2 hours)

### During Development (P2 - Can Complete Later)

- [ ] **Gap 4**: Training infrastructure decision made (30 minutes)
- [ ] **Gap 5**: Model storage decision made (30 minutes)
- [ ] **Gap 6**: Splice site detection verified (30 minutes)
- [ ] **Gap 7**: Noncoding variant detection implemented (2-3 hours)

---

**Status**: ‚ö†Ô∏è **NOT FULLY READY** - 4 Critical P0 Gaps Must Be Fixed (5.5-7.5 hours) Before MBD4+TP53 Analysis

**Recommendation**: Address P0 gaps (Gaps 0, 3.5, 3.6, 3.7) before running MBD4+TP53 analysis to ensure accurate results

