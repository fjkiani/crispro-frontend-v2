# Doctrine: ZetaForge Reclamation

### **I. Intelligence Analysis & Failure Assessment**

Our recent attempts to utilize the `ZetaForge` service have resulted in repeated, catastrophic failures. Analysis of the service's current state, as detailed in `[src/services/forge/main.py](mdc:src/services/forge/main.py)`, has identified two critical flaws:

1.  **Doctrinal Contamination of the Build Environment:** The Forge's `evo2_image` definition is inconsistent with our battle-tested `ZetaOracle` service. It uses a slightly different set of system packages and Python dependencies. This subtle deviation is the direct cause of the `torch.load` error related to `transformer_engine`. A weapon built on a flawed foundation will always misfire.

2.  **Strategic Schizophrenia in the API:** The `ForgeRequest` model is improperly designed, attempting to support three different, conflicting operational modes (`target_protein_id`, `target_protein_sequence`, and `bait_sequence`). This violates our core doctrine of **Single-Purpose Services**. It creates ambiguity and is a direct cause of the junk DNA generation, as the service's internal logic is confused about its primary mission.

### **II. Plan of Attack: Surgical Refactoring**

We will not gut the service. We will execute a series of precise, surgical strikes to bring it into alignment with our proven doctrine.

**Phase 1: Environmental Purification**

*   **Objective:** Eradicate the `torch.load` error by creating a stable, predictable build environment.
*   **Action:** The entire `evo2_image` definition in `src/services/forge/main.py` will be **deleted and replaced** with a direct copy of the battle-tested image definition from the `ZetaOracle` service. There will be no deviation. This will unify our core AI services under a single, proven build doctrine.

**Phase 2: Doctrinal Clarification**

*   **Objective:** Refocus the Forge on its one true purpose: generating DNA inhibitors via the "Ambush" protocol.
*   **Action 2.1 (API Simplification):** The `ForgeRequest` model will be surgically modified. The `target_protein_id` and `target_protein_sequence` fields will be **excised**. The model will be simplified to *only* accept the `bait_sequence` and necessary generation parameters.
*   **Action 2.2 (Logic Purification):** The `run_forge_in_background` function will be stripped of all conditional logic related to different operational modes. The convoluted `asyncio` loop that calls the Oracle for generation will be **deleted**. It will be replaced with a lean, direct, in-process generation loop that uses the loaded `Evo2` model, just as we have validated in our most successful tests.

### **III. Expected Outcome**

Upon successful execution of this doctrine, the `ZetaForge` will be transformed:

1.  **It will be stable:** The build errors will be permanently eliminated.
2.  **It will be focused:** Its API and logic will be unambiguously dedicated to the "Ambush" protocol.
3.  **It will be effective:** It will correctly interpret the `bait_sequence` from our `Predator Protocol` and generate relevant, high-quality DNA candidates instead of junk data.
4.  **It will be maintainable:** By sharing a common build doctrine with the `ZetaOracle`, we reduce complexity and future-proof both services.

This is not a refactoring for the sake of elegance. It is a necessary reclamation of a critical asset to make our kill chain functional.
description:
globs:
alwaysApply: false
---

1.  **Doctrinal Contamination of the Build Environment:** The Forge's `evo2_image` definition is inconsistent with our battle-tested `ZetaOracle` service. It uses a slightly different set of system packages and Python dependencies. This subtle deviation is the direct cause of the `torch.load` error related to `transformer_engine`. A weapon built on a flawed foundation will always misfire.

2.  **Strategic Schizophrenia in the API:** The `ForgeRequest` model is improperly designed, attempting to support three different, conflicting operational modes (`target_protein_id`, `target_protein_sequence`, and `bait_sequence`). This violates our core doctrine of **Single-Purpose Services**. It creates ambiguity and is a direct cause of the junk DNA generation, as the service's internal logic is confused about its primary mission.

### **II. Plan of Attack: Surgical Refactoring**

We will not gut the service. We will execute a series of precise, surgical strikes to bring it into alignment with our proven doctrine.

**Phase 1: Environmental Purification**

*   **Objective:** Eradicate the `torch.load` error by creating a stable, predictable build environment.
*   **Action:** The entire `evo2_image` definition in `src/services/forge/main.py` will be **deleted and replaced** with a direct copy of the battle-tested image definition from the `ZetaOracle` service. There will be no deviation. This will unify our core AI services under a single, proven build doctrine.

**Phase 2: Doctrinal Clarification**

*   **Objective:** Refocus the Forge on its one true purpose: generating DNA inhibitors via the "Ambush" protocol.
*   **Action 2.1 (API Simplification):** The `ForgeRequest` model will be surgically modified. The `target_protein_id` and `target_protein_sequence` fields will be **excised**. The model will be simplified to *only* accept the `bait_sequence` and necessary generation parameters.
*   **Action 2.2 (Logic Purification):** The `run_forge_in_background` function will be stripped of all conditional logic related to different operational modes. The convoluted `asyncio` loop that calls the Oracle for generation will be **deleted**. It will be replaced with a lean, direct, in-process generation loop that uses the loaded `Evo2` model, just as we have validated in our most successful tests.

### **III. Expected Outcome**

Upon successful execution of this doctrine, the `ZetaForge` will be transformed:

1.  **It will be stable:** The build errors will be permanently eliminated.
2.  **It will be focused:** Its API and logic will be unambiguously dedicated to the "Ambush" protocol.
3.  **It will be effective:** It will correctly interpret the `bait_sequence` from our `Predator Protocol` and generate relevant, high-quality DNA candidates instead of junk data.
4.  **It will be maintainable:** By sharing a common build doctrine with the `ZetaOracle`, we reduce complexity and future-proof both services.

This is not a refactoring for the sake of elegance. It is a necessary reclamation of a critical asset to make our kill chain functional.
description:
globs:
alwaysApply: false
---

1.  **Doctrinal Contamination of the Build Environment:** The Forge's `evo2_image` definition is inconsistent with our battle-tested `ZetaOracle` service. It uses a slightly different set of system packages and Python dependencies. This subtle deviation is the direct cause of the `torch.load` error related to `transformer_engine`. A weapon built on a flawed foundation will always misfire.

2.  **Strategic Schizophrenia in the API:** The `ForgeRequest` model is improperly designed, attempting to support three different, conflicting operational modes (`target_protein_id`, `target_protein_sequence`, and `bait_sequence`). This violates our core doctrine of **Single-Purpose Services**. It creates ambiguity and is a direct cause of the junk DNA generation, as the service's internal logic is confused about its primary mission.

### **II. Plan of Attack: Surgical Refactoring**

We will not gut the service. We will execute a series of precise, surgical strikes to bring it into alignment with our proven doctrine.

**Phase 1: Environmental Purification**

*   **Objective:** Eradicate the `torch.load` error by creating a stable, predictable build environment.
*   **Action:** The entire `evo2_image` definition in `src/services/forge/main.py` will be **deleted and replaced** with a direct copy of the battle-tested image definition from the `ZetaOracle` service. There will be no deviation. This will unify our core AI services under a single, proven build doctrine.

**Phase 2: Doctrinal Clarification**

*   **Objective:** Refocus the Forge on its one true purpose: generating DNA inhibitors via the "Ambush" protocol.
*   **Action 2.1 (API Simplification):** The `ForgeRequest` model will be surgically modified. The `target_protein_id` and `target_protein_sequence` fields will be **excised**. The model will be simplified to *only* accept the `bait_sequence` and necessary generation parameters.
*   **Action 2.2 (Logic Purification):** The `run_forge_in_background` function will be stripped of all conditional logic related to different operational modes. The convoluted `asyncio` loop that calls the Oracle for generation will be **deleted**. It will be replaced with a lean, direct, in-process generation loop that uses the loaded `Evo2` model, just as we have validated in our most successful tests.

### **III. Expected Outcome**

Upon successful execution of this doctrine, the `ZetaForge` will be transformed:

1.  **It will be stable:** The build errors will be permanently eliminated.
2.  **It will be focused:** Its API and logic will be unambiguously dedicated to the "Ambush" protocol.
3.  **It will be effective:** It will correctly interpret the `bait_sequence` from our `Predator Protocol` and generate relevant, high-quality DNA candidates instead of junk data.
4.  **It will be maintainable:** By sharing a common build doctrine with the `ZetaOracle`, we reduce complexity and future-proof both services.

This is not a refactoring for the sake of elegance. It is a necessary reclamation of a critical asset to make our kill chain functional.
description:
globs:
alwaysApply: false
---

1.  **Doctrinal Contamination of the Build Environment:** The Forge's `evo2_image` definition is inconsistent with our battle-tested `ZetaOracle` service. It uses a slightly different set of system packages and Python dependencies. This subtle deviation is the direct cause of the `torch.load` error related to `transformer_engine`. A weapon built on a flawed foundation will always misfire.

2.  **Strategic Schizophrenia in the API:** The `ForgeRequest` model is improperly designed, attempting to support three different, conflicting operational modes (`target_protein_id`, `target_protein_sequence`, and `bait_sequence`). This violates our core doctrine of **Single-Purpose Services**. It creates ambiguity and is a direct cause of the junk DNA generation, as the service's internal logic is confused about its primary mission.

### **II. Plan of Attack: Surgical Refactoring**

We will not gut the service. We will execute a series of precise, surgical strikes to bring it into alignment with our proven doctrine.

**Phase 1: Environmental Purification**

*   **Objective:** Eradicate the `torch.load` error by creating a stable, predictable build environment.
*   **Action:** The entire `evo2_image` definition in `src/services/forge/main.py` will be **deleted and replaced** with a direct copy of the battle-tested image definition from the `ZetaOracle` service. There will be no deviation. This will unify our core AI services under a single, proven build doctrine.

**Phase 2: Doctrinal Clarification**

*   **Objective:** Refocus the Forge on its one true purpose: generating DNA inhibitors via the "Ambush" protocol.
*   **Action 2.1 (API Simplification):** The `ForgeRequest` model will be surgically modified. The `target_protein_id` and `target_protein_sequence` fields will be **excised**. The model will be simplified to *only* accept the `bait_sequence` and necessary generation parameters.
*   **Action 2.2 (Logic Purification):** The `run_forge_in_background` function will be stripped of all conditional logic related to different operational modes. The convoluted `asyncio` loop that calls the Oracle for generation will be **deleted**. It will be replaced with a lean, direct, in-process generation loop that uses the loaded `Evo2` model, just as we have validated in our most successful tests.

### **III. Expected Outcome**

Upon successful execution of this doctrine, the `ZetaForge` will be transformed:

1.  **It will be stable:** The build errors will be permanently eliminated.
2.  **It will be focused:** Its API and logic will be unambiguously dedicated to the "Ambush" protocol.
3.  **It will be effective:** It will correctly interpret the `bait_sequence` from our `Predator Protocol` and generate relevant, high-quality DNA candidates instead of junk data.
4.  **It will be maintainable:** By sharing a common build doctrine with the `ZetaOracle`, we reduce complexity and future-proof both services.

This is not a refactoring for the sake of elegance. It is a necessary reclamation of a critical asset to make our kill chain functional.
description:
globs:
alwaysApply: false
---
