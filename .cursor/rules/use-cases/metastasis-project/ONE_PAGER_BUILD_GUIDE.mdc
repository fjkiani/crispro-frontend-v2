---
description: Complete build guide for generating the Metastasis Interception 1-pager PDF from JSON template
alwaysApply: false
---

# üìÑ One-Pager Build Guide - Metastasis Interception Publication

## üéØ Purpose

This guide explains how another agent (or human) can use [`ONE_PAGER_TEMPLATE.json`](mdc:.cursor/rules/use-cases/metastasis-project/ONE_PAGER_TEMPLATE.json) to automatically generate a publication-grade 1-page summary PDF.

---

## üìã What You're Building

**Output:** `publication/METASTASIS_INTERCEPTION_ONE_PAGER.pdf`
- **Format:** Letter size (8.5" √ó 11"), 2-column layout
- **Content:** Complete publication summary with metrics, charts, structural validation results
- **Quality:** 300 DPI, publication-ready
- **Time:** ~10 minutes automated build

---

## üèóÔ∏è Build Steps

### **Step 1: Read the Template**
```python
import json
template = json.load(open('.cursor/rules/use-cases/metastasis-project/ONE_PAGER_TEMPLATE.json'))
```

### **Step 2: Extract Data from Sources**

The template's `data_sources` section points to all files you need:

```python
import pandas as pd

# Load validation metrics
per_step_df = pd.read_csv('publication/data/per_step_validation_metrics.csv')
structural_df = pd.read_csv('publication/structural_validation/structural_metrics_summary.csv')
guide_details_df = pd.read_csv('publication/data/guide_structural_details.csv')

# Extract key metrics
target_lock_auroc = per_step_df['auroc'].mean()  # Should be ~0.976
structural_pass_rate = (structural_df['verdict'] == 'PASS').sum() / len(structural_df)  # Should be 1.0
mean_plddt = structural_df['plddt_mean'].mean()  # Should be ~65.6
mean_iptm = structural_df['iptm'].mean()  # Should be ~0.36
```

### **Step 3: Generate Charts**

**Chart 1: Per-Step AUROC Bar Chart**
```python
import matplotlib.pyplot as plt
import seaborn as sns

# Set color scheme from template
colors = {
    'primary': '#2C3E50',
    'accent': '#4ECDC4',
    'success': '#27AE60'
}

# Create bar chart
fig, ax = plt.subplots(figsize=(6, 3))
steps = per_step_df['step'].values
aurocs = per_step_df['auroc'].values

ax.bar(range(len(steps)), aurocs, color=colors['accent'], edgecolor=colors['primary'], linewidth=1.5)
ax.axhline(y=0.95, color=colors['success'], linestyle='--', linewidth=2, label='Threshold (0.95)')
ax.set_xticks(range(len(steps)))
ax.set_xticklabels([s[:8] for s in steps], rotation=45, ha='right', fontsize=8)
ax.set_ylabel('AUROC', fontsize=10, fontweight='bold')
ax.set_ylim(0.9, 1.0)
ax.legend(fontsize=8)
ax.grid(axis='y', alpha=0.3)

plt.tight_layout()
plt.savefig('temp_per_step_auroc.png', dpi=300, bbox_inches='tight')
plt.close()
```

**Chart 2: pLDDT Distribution Violin Plot**
```python
# Extract pLDDT values
plddt_vals = structural_df['plddt_mean'].values

fig, ax = plt.subplots(figsize=(2, 3))
parts = ax.violinplot([plddt_vals], positions=[0], widths=0.5, showmeans=True, showmedians=True)
for pc in parts['bodies']:
    pc.set_facecolor(colors['accent'])
    pc.set_alpha(0.7)

ax.axhline(y=50, color='red', linestyle='--', linewidth=1.5, label='Threshold (‚â•50)')
ax.set_ylabel('pLDDT Score', fontsize=10, fontweight='bold')
ax.set_xticks([])
ax.set_ylim(60, 72)
ax.legend(fontsize=7)

plt.tight_layout()
plt.savefig('temp_plddt_violin.png', dpi=300, bbox_inches='tight')
plt.close()
```

### **Step 4: Build PDF Layout**

**Option A: Using ReportLab (Python)**
```python
from reportlab.lib.pagesizes import letter
from reportlab.lib.units import inch
from reportlab.platypus import SimpleDocTemplate, Table, TableStyle, Paragraph, Spacer, Image
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib import colors as rl_colors

# Create PDF
pdf_file = 'publication/METASTASIS_INTERCEPTION_ONE_PAGER.pdf'
doc = SimpleDocTemplate(pdf_file, pagesize=letter, 
                       leftMargin=0.5*inch, rightMargin=0.5*inch,
                       topMargin=0.5*inch, bottomMargin=0.5*inch)

story = []
styles = getSampleStyleSheet()

# Header
header_style = ParagraphStyle('Header', parent=styles['Heading1'], 
                              fontSize=18, textColor=rl_colors.HexColor('#2C3E50'))
story.append(Paragraph(template['title'], header_style))
story.append(Spacer(1, 0.1*inch))

# Hero Metrics (4-column table)
hero_data = []
for metric in template['hero_metrics_section']['metrics']:
    hero_data.append([metric['icon'], metric['value'], metric['label'], metric['sublabel']])

hero_table = Table(hero_data, colWidths=[0.5*inch, 1*inch, 1.5*inch, 1.5*inch])
hero_table.setStyle(TableStyle([
    ('ALIGN', (0,0), (-1,-1), 'CENTER'),
    ('FONTSIZE', (0,0), (-1,-1), 10),
    ('BACKGROUND', (0,0), (-1,0), rl_colors.HexColor('#4ECDC4')),
    ('TEXTCOLOR', (0,0), (-1,0), rl_colors.white),
]))
story.append(hero_table)
story.append(Spacer(1, 0.2*inch))

# Add charts as images
story.append(Image('temp_per_step_auroc.png', width=6*inch, height=3*inch))
story.append(Spacer(1, 0.1*inch))
story.append(Image('temp_plddt_violin.png', width=2*inch, height=3*inch))

# Build PDF
doc.build(story)
print(f"‚úÖ PDF generated: {pdf_file}")
```

**Option B: Using LaTeX (More Control)**
```python
# Generate LaTeX source
latex_template = r"""
\documentclass[10pt]{article}
\usepackage[margin=0.5in, letterpaper]{geometry}
\usepackage{graphicx}
\usepackage{multicol}
\usepackage{xcolor}
\usepackage{tikz}

\definecolor{primary}{HTML}{2C3E50}
\definecolor{accent}{HTML}{4ECDC4}
\definecolor{success}{HTML}{27AE60}

\begin{document}

\begin{center}
{\Huge\textbf{Metastasis Interception}}\\[5pt]
{\Large AI-Powered Stage-Specific CRISPR Design}\\[10pt]
\colorbox{success}{\textcolor{white}{\textbf{100\% VALIDATED}}} \quad
\colorbox{accent}{\textcolor{white}{\textbf{PUBLICATION-READY}}}
\end{center}

\begin{multicols}{2}

\section*{The Problem}
\begin{itemize}
    \item 90\% of cancer deaths from metastasis
    \item Traditional tools target primary tumors only
    \item 8 metastatic steps, each with different drivers
\end{itemize}

\section*{Key Results}
\begin{center}
\begin{tabular}{lcc}
\textbf{Metric} & \textbf{Value} & \textbf{Benchmark} \\
\hline
Structural Pass & 100\% & Industry: 60\% \\
pLDDT & 65.6¬±1.8 & Threshold: ‚â•50 \\
iPTM & 0.36¬±0.01 & RNA-DNA: ‚â•0.30 \\
AUROC & 0.976¬±0.035 & Random: 0.50 \\
\end{tabular}
\end{center}

\includegraphics[width=\linewidth]{temp_per_step_auroc.png}

\end{multicols}

\end{document}
"""

with open('temp_onepager.tex', 'w') as f:
    f.write(latex_template)

# Compile
import subprocess
subprocess.run(['pdflatex', 'temp_onepager.tex'])
subprocess.run(['mv', 'temp_onepager.pdf', 'publication/METASTASIS_INTERCEPTION_ONE_PAGER.pdf'])
```

### **Step 5: Clean Up Temp Files**
```python
import os
for temp_file in ['temp_per_step_auroc.png', 'temp_plddt_violin.png', 'temp_onepager.tex', 'temp_onepager.aux', 'temp_onepager.log']:
    if os.path.exists(temp_file):
        os.remove(temp_file)
```

---

## üìä Data Mapping Guide

### **Where to Find Each Metric**

| Metric | Source File | Column/Field | Transformation |
|--------|-------------|--------------|----------------|
| Structural Pass Rate | `structural_metrics_summary.csv` | `verdict` | Count "PASS" / total |
| pLDDT Mean | `structural_metrics_summary.csv` | `plddt_mean` | `mean()` |
| iPTM Mean | `structural_metrics_summary.csv` | `iptm` | `mean()` |
| Target Lock AUROC | `per_step_validation_metrics.csv` | `auroc` | `mean()` across steps |
| Precision@3 | `per_step_validation_metrics.csv` | `precision_at_3` | `mean()` |
| Guide Efficacy Corr | `EXECUTIVE_SUMMARY.md` | Line 24 | "0.71 correlation" |
| Cost Savings | `EXECUTIVE_SUMMARY.md` | Lines 137-143 | "$1.5M" |
| Time Savings | `EXECUTIVE_SUMMARY.md` | Lines 137-143 | "12 months" |

### **Per-Step AUROC Data**
```python
# From per_step_validation_metrics.csv
steps = [
    "primary_growth",
    "local_invasion", 
    "intravasation",
    "survival_in_circulation",
    "extravasation",
    "micrometastasis_formation",
    "angiogenesis",
    "metastatic_colonization"
]

aurocs = per_step_df.set_index('step').loc[steps, 'auroc'].values
```

---

## üé® Visual Customization

### **Color Scheme**
The template defines 4 colors:
- **Primary (`#2C3E50`)**: Headers, borders, text
- **Accent (`#4ECDC4`)**: Charts, highlights, badges
- **Success (`#27AE60`)**: Checkmarks, pass indicators
- **Warning (`#E74C3C`)**: Thresholds, caution notes

Apply consistently across all charts and text.

### **Typography**
- **Headings:** Arial Bold, 18pt
- **Subheadings:** Arial Bold, 14pt
- **Body:** Arial, 10pt
- **Captions:** Arial, 8pt

### **Spacing**
- Section spacing: 0.2 inches
- Paragraph spacing: 0.1 inches
- Margins: 0.5 inches all sides

---

## ‚úÖ Quality Checklist

Before finalizing, verify:

- [ ] All metrics match source files (no hardcoding)
- [ ] Charts render at 300 DPI
- [ ] Text is readable (minimum 8pt font)
- [ ] Color scheme is consistent
- [ ] No overlapping elements
- [ ] All 15 guides accounted for in structural data
- [ ] AUROC values for all 8 steps present
- [ ] PDF exports at Letter size (8.5" √ó 11")
- [ ] File size <5 MB
- [ ] "Research Use Only" disclaimer included

---

## üöÄ Alternative Formats

### **PowerPoint Slide (16:9)**
```python
from pptx import Presentation
from pptx.util import Inches, Pt

prs = Presentation()
prs.slide_width = Inches(10)
prs.slide_height = Inches(5.625)

slide = prs.slides.add_slide(prs.slide_layouts[6])  # Blank layout

# Add title
title_box = slide.shapes.add_textbox(Inches(0.5), Inches(0.5), Inches(9), Inches(0.5))
title_frame = title_box.text_frame
title_frame.text = "Metastasis Interception: 100% Structural Validation"

# Add hero metrics (4 boxes across top)
metrics = template['hero_metrics_section']['metrics']
for i, metric in enumerate(metrics):
    left = Inches(0.5 + i * 2.25)
    box = slide.shapes.add_textbox(left, Inches(1.2), Inches(2), Inches(0.8))
    frame = box.text_frame
    frame.text = f"{metric['icon']} {metric['value']}\n{metric['label']}"

# Add charts
slide.shapes.add_picture('temp_per_step_auroc.png', Inches(0.5), Inches(2.5), width=Inches(4))
slide.shapes.add_picture('temp_plddt_violin.png', Inches(5), Inches(2.5), width=Inches(2))

prs.save('publication/METASTASIS_INTERCEPTION_SLIDE.pptx')
```

### **Web Version (HTML + D3.js)**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Metastasis Interception - Interactive</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .hero-metrics { display: flex; justify-content: space-around; margin: 20px 0; }
        .metric-box { text-align: center; padding: 20px; background: #4ECDC4; color: white; border-radius: 10px; }
        .metric-value { font-size: 48px; font-weight: bold; }
        .metric-label { font-size: 16px; }
    </style>
</head>
<body>
    <h1>Metastasis Interception: 100% Structural Validation</h1>
    
    <div class="hero-metrics">
        <div class="metric-box">
            <div class="metric-value">100%</div>
            <div class="metric-label">Structural Validation</div>
        </div>
        <!-- Add other metrics -->
    </div>
    
    <div id="chart"></div>
    
    <script>
        // Load data and create interactive D3 charts
        d3.csv('publication/data/per_step_validation_metrics.csv').then(data => {
            // Build interactive bar chart with tooltips
        });
    </script>
</body>
</html>
```

---

## üìù Customization Instructions

### **For Academic Publications**
- Emphasize scientific rigor (100% validation, literature-calibrated thresholds)
- Include full citation info (Abramson 2024, Nishimasu 2014)
- Add "Research Use Only" disclaimer prominently

### **For Investor Presentations**
- Lead with commercial impact ($1.5M savings, 12 months faster)
- Emphasize market size (8 metastatic steps = 8x addressable market)
- Include competitive comparison table (vs Benchling/CRISPOR)

### **For Conference Posters**
- Scale to A0 size (33.1" √ó 46.8")
- Increase font sizes (18pt body, 36pt headings)
- Add QR code linking to GitHub/paper

---

## üîß Troubleshooting

### **Issue: Charts don't render**
**Solution:** Ensure matplotlib/seaborn installed: `pip install matplotlib seaborn`

### **Issue: PDF fonts look wrong**
**Solution:** Install Arial font or substitute with Helvetica in reportlab

### **Issue: Data files not found**
**Solution:** Run from workspace root: `cd /path/to/crispr-assistant-main`

### **Issue: LaTeX compilation fails**
**Solution:** Install TeXLive: `brew install --cask mactex` (Mac) or `apt-get install texlive-full` (Linux)

---

## üìû Support & Contact

**For questions about this build guide:**
- See template: [`ONE_PAGER_TEMPLATE.json`](mdc:.cursor/rules/use-cases/metastasis-project/ONE_PAGER_TEMPLATE.json)
- Review source data: `publication/data/` and `publication/structural_validation/`
- Check blog for context: [`blog_metastasis_interception_v2_structural.mdc`](mdc:.cursor/rules/blog_metastasis_interception_v2_structural.mdc)

**Expected build time:** 10 minutes (automated), 1 hour (manual customization)

---

**Last Updated:** October 18, 2025  
**Version:** 1.0  
**Agent:** Zo  
**Status:** ‚úÖ Ready for implementation by another agent
